<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Study Designs · TarGene</title><meta name="title" content="Study Designs · TarGene"/><meta property="og:title" content="Study Designs · TarGene"/><meta property="twitter:title" content="Study Designs · TarGene"/><meta name="description" content="Documentation for TarGene."/><meta property="og:description" content="Documentation for TarGene."/><meta property="twitter:description" content="Documentation for TarGene."/><meta property="og:url" content="https://TARGENE.github.io/targene-pipeline/targene/study_designs/"/><meta property="twitter:url" content="https://TARGENE.github.io/targene-pipeline/targene/study_designs/"/><link rel="canonical" href="https://TARGENE.github.io/targene-pipeline/targene/study_designs/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TarGene</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Workflows</span><ul><li><a class="tocitem" href="../../overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">The TarGene Workflow </span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../overview/">The TarGene Workflow</a></li><li><a class="tocitem" href="../data_sources/">Setting a Data Source</a></li><li><a class="tocitem" href="../confounding_adjustment/">Adjusting for confounders</a></li><li class="is-active"><a class="tocitem" href>Study Designs</a><ul class="internal"><li><a class="tocitem" href="#CUSTOM"><span><code>CUSTOM</code></span></a></li><li><a class="tocitem" href="#ALLELE_INDEPENDENT"><span><code>ALLELE_INDEPENDENT</code></span></a></li><li><a class="tocitem" href="#FROM_ACTORS"><span><code>FROM_ACTORS</code></span></a></li></ul></li><li><a class="tocitem" href="../tmle/">Specifying a Targeted Estimator</a></li><li><a class="tocitem" href="../sieve_variance/">Correcting for population relatedness</a></li><li><a class="tocitem" href="../miscellaneous/">Tweaking additional behaviour</a></li><li><a class="tocitem" href="../configuration/">Configuration</a></li><li><a class="tocitem" href="../runtime_considerations/">Some Runtime considerations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Negative Control</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../negative_control/overview/">Negative Control Overview</a></li><li><a class="tocitem" href="../../negative_control/permutation_tests/">The Permutation Test Workflow</a></li><li><a class="tocitem" href="../../negative_control/randomized_tests/">The Randomized Variants Workflow</a></li></ul></li><li><a class="tocitem" href="../../secondary_workflows/pca/">The PCA Workflow</a></li><li><a class="tocitem" href="../../secondary_workflows/make_dataset/">The Make Dataset Workflow</a></li></ul></li><li><span class="tocitem">Developper Guide</span><ul><li><a class="tocitem" href="../../developper_guide/project_organization/">Project Organization</a></li><li><a class="tocitem" href="../../developper_guide/contribution_guide/">Contributing</a></li></ul></li><li><a class="tocitem" href="../../associated_softwares/">Associated Softwares</a></li><li><a class="tocitem" href="../../publications/">Related Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Workflows</a></li><li><a class="is-disabled">The TarGene Workflow </a></li><li class="is-active"><a href>Study Designs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Study Designs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TARGENE/targene-pipeline/blob/main/docs/src/targene/study_designs.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Study-Designs"><a class="docs-heading-anchor" href="#Study-Designs">Study Designs</a><a id="Study-Designs-1"></a><a class="docs-heading-anchor-permalink" href="#Study-Designs" title="Permalink"></a></h1><p>A study design describes what are the questions of interest for a given TarGene run. In particular, it answers the two following questions:</p><ul><li>What variants are of interest?</li><li>What are the quantities of interest: Average Treatment Effects, Epistatic Interactions, Gene by Environment Interactions, ...?</li></ul><p>While specifying your estimands, it may be useful to keep the following causal model in mind.</p><p><img src="../../assets/causal_graph.png" alt="Causal Graph"/></p><p>Where <span>$V_1...V_p$</span> are a set of genetic variants, the <span>$Y_1...Y_K$</span> are a set of traits and <span>$C$</span> are a set of additional predictors for <span>$Y$</span> but not confounding the genetic effects.</p><p>The following sections describe the available study designs available in TarGene and assumes the following notations:</p><ul><li>ATE: Average Treatment Effect</li><li>IATE: Interaction Average Treatment Effect</li><li>CM: Conditional Mean</li></ul><h2 id="CUSTOM"><a class="docs-heading-anchor" href="#CUSTOM"><code>CUSTOM</code></a><a id="CUSTOM-1"></a><a class="docs-heading-anchor-permalink" href="#CUSTOM" title="Permalink"></a></h2><p>This is the most general setting and should match the needs of any project, however it requires some preliminary work. In this setting, one typically provides a file containing a list of the estimands of interest. If you are interested in only a few estimands, it may be acceptable to write them by hand. Otherwise it is best to generate them using a programming language (for instance using <a href="https://targene.github.io/TMLE.jl/stable/">TMLE.jl</a>). The path to those estimands is then provided with the <code>ESTIMANDS_FILE</code> Nextflow parameter. Estimands are specified via a YAML file as follows:</p><pre><code class="language-yaml hljs">type: &quot;Configuration&quot;
estimands:
  - outcome_extra_covariates: []
    type: &quot;ATE&quot;
    treatment_values:
      3:3502414:T:C:
        case: &quot;TT&quot;
        control: &quot;CT&quot;
      1:238411180:T:C:
        case: &quot;TC&quot;
        control: &quot;TT&quot;
    outcome: ALL
    treatment_confounders: []
  - outcome_extra_covariates: []
    type: &quot;IATE&quot;
    treatment_values:
      3:3502414:T:C:
        case: &quot;TT&quot;
        control: &quot;CT&quot;
      1:238411180:T:C:
        case: &quot;TC&quot;
        control: &quot;TT&quot;
    outcome: ALL
    treatment_confounders:
      3:3502414:T:C: []
      1:238411180:T:C: []
  - outcome_extra_covariates: []
    type: &quot;CM&quot;
    treatment_values:
      3:3502414:T:C: &quot;CT&quot;
      1:238411180:T:C: &quot;TC&quot;
    outcome: ALL
    treatment_confounders:
      3:3502414:T:C: []
      1:238411180:T:C: []
  - outcome_extra_covariates: []
    type: &quot;ATE&quot;
    treatment_values:
      2:14983:G:A:
        case: &quot;GG&quot;
        control: &quot;AG&quot;
    outcome: ALL
    treatment_confounders: []
  - outcome_extra_covariates: []
    type: &quot;CM&quot;
    treatment_values:
      2:14983:G:A: &quot;AG&quot;
    outcome: ALL
    treatment_confounders: []</code></pre><p>For each estimand:</p><ul><li><code>type</code>: refers to the type of effect size (ATE, IATE, CM)</li><li><code>outcome</code>: The trait of interest. If using the Uk-Biobank datasource it must match the <code>phenotypes/name</code> field in the associated <code>UKB_CONFIG</code> file. You can also use the wildcard &quot;ALL&quot; to specify that you want to estimate this parameter accross all traits in the dataset.</li><li><code>treatment_values</code>: For each treatment variable (genetic-variant / environmental variables), the control/case contrasts.</li><li><code>treatment_confounders</code>: If each treatment&#39;s set of confounding variables is assumed to be the same, it can be a list of these variables. Otherwise, for each treatment variable, a list of confounding variables. Note that principal components will be added to that list automatically and must not be provided here. You can provide an empty list.</li><li><code>outcome_extra_covariates</code>: This is optional and correspond to a list of additional covariates for the prediction of the trait.</li></ul><p>Note that variants must be encoded via an explicit genotype string representation (e.g. &quot;AC&quot;), the order of the alleles in the genotype is not important.</p><h2 id="ALLELE_INDEPENDENT"><a class="docs-heading-anchor" href="#ALLELE_INDEPENDENT"><code>ALLELE_INDEPENDENT</code></a><a id="ALLELE_INDEPENDENT-1"></a><a class="docs-heading-anchor-permalink" href="#ALLELE_INDEPENDENT" title="Permalink"></a></h2><p>This mode aims to make it easy to generate estimands without explicitly having to write them down. We still rely on a YAML <code>ESTIMANDS_FILE</code>, that contains the following fields:</p><ul><li><code>type</code>: How the variants will be combined to generate estimands (see below).</li><li><code>estimands</code>: A list of the followings:<ul><li><code>type</code>: The type of generated estimands (<code>CM</code>, <code>ATE</code>, <code>IATE</code>)</li><li><code>orders</code>: With respect to treatment variables if more than two are provided, the combination orders to be generated. For interactions, the order is always greater or equal than 2.</li></ul></li><li><code>variants</code>: The list of genetic variants of interest, see below for how this can be specified.</li><li><code>extra_treatments</code>: Environmental treatment variables that are added to the treatments combinations.</li><li><code>outcome_extra_covariates</code>: Additional covariates predictive of the outcomes</li><li><code>extra_confounders</code>: Confounding variables other than Principal Components.</li></ul><p>In TarGene, the effect of a variant (or set of variants) on a trait is not defined in terms of a parametric model. As such, the effect size of a variant on a trait is in fact multidimensional, a vector for which each entry corresponds to a specific <strong>genotype change</strong>. As an example, if a variant RSID_17 has two alleles &quot;A&quot; and &quot;G&quot;, some possible genotype changes are: AA → AG, AG → GG, AA → GG, GG → AA, ... However, some effects of these changes are redundant, e.g. the effect of AA → GG can be obtained from the effects of AA → AG and AG → GG via simple addition. TarGene will only compute transitive changes, in this case only: AA → AG and AG → GG need to be estimated since any other change can be obtained from them.</p><h3 id="type-flat"><a class="docs-heading-anchor" href="#type-flat">type = flat</a><a id="type-flat-1"></a><a class="docs-heading-anchor-permalink" href="#type-flat" title="Permalink"></a></h3><p>In this mode, genetic variants are provided as a flat list, for each estimand type and order specified in the <code>estimands</code> section, the estimands are generated using combinations.</p><p>For example, with the following file:</p><pre><code class="language-yaml hljs">type: flat

estimands:
  - type: IATE
    orders: [2, 3]
  - type: ATE

variants:
  - RSID_17
  - RSID_99
  - RSID_102

extra_treatments:
  - TREAT_1

outcome_extra_covariates:
  - COV_1

extra_confounders:
  - 21003
  - 22001</code></pre><ul><li>Average Treatment Effects of <code>order</code> 1 (default) for all (RSID<em>17, RSID</em>99, RSID<em>102, TREAT</em>1) are generated</li><li>Interaction Effects of <code>order</code> 2 and 3 for all combinations of (RSID<em>17, RSID</em>99, RSID<em>102, TREAT</em>1) are generated. Some of these combinations are:<ul><li>(RSID<em>17, RSID</em>99)</li><li>(RSID<em>102, TREAT</em>1)</li><li>(RSID<em>102, RSID</em>99, TREAT_1)</li><li>...</li></ul></li></ul><h3 id="type-groups"><a class="docs-heading-anchor" href="#type-groups">type = groups</a><a id="type-groups-1"></a><a class="docs-heading-anchor-permalink" href="#type-groups" title="Permalink"></a></h3><p>When the number of variants becomes large, estimating all combinations becomes both computationally expensive and reduces power due to the associated multiple testing burden. If the genetic variants are not chosen at random but based on some biological mechanism (e.g. a transcription factor), it is more efficient to group them. Within each group further subgroups can be defined for the roles played by each variant, only combinations across groups are considered.</p><p>For example, the following file describes two groups each consisting of two subgroups:</p><pre><code class="language-yaml hljs">type: groups
estimands:
  - type: IATE
    orders: [2, 3]
variants:
  TF1:
    bQTLs:
      - RSID_17
      - RSID_99
    eQTLs:
      - RSID_102
  TF2:
    bQTLs:
      - RSID_17
      - RSID_198
    eQTLs:
      - RSID_2
extra_treatments:
  - TREAT_1
outcome_extra_covariates:
  - COV_1
extra_confounders:
  - 21003
  - 22001</code></pre><p>For group <code>TF1</code>, only (RSID<em>17, RSID</em>102) and (RSID<em>99, RSID</em>102) are considered and similarly for group <code>TF2</code>.</p><h2 id="FROM_ACTORS"><a class="docs-heading-anchor" href="#FROM_ACTORS"><code>FROM_ACTORS</code></a><a id="FROM_ACTORS-1"></a><a class="docs-heading-anchor-permalink" href="#FROM_ACTORS" title="Permalink"></a></h2><p>In this setting the goal is to infer the interaction effect between multiple variants and potential external factors, interacting together via a specific biological mechanism. Typically, multiple sets of variants are of interest and each set is identified with a specific molecule, contributing to the mechanism. In particular, it is assumed that a set of variants, usually binding quantitative trait loci (bQTLs) play a pivotal role. All interactions of interest are thus defined with respect to that set of genetic variations. Let&#39;s Consider the following scenario: we know that a transcription factor binds to molecules <code>x</code> and <code>y</code> and then differentially binds to specific regions in the genome (<code>bQTLs</code>) to regulate downstream genes. We suspect that an alteration of this mechanism is responsible for some diseases. A set of <code>xQTLs</code>, associated with the expression of <code>x</code> and a set of <code>yQTLs</code> associated with the expression of <code>y</code> have been identified. Together <code>xQTLs</code> and <code>yQTLs</code> variants are termed &quot;trans actors&quot;. We further suspect that some environmental factors may influence this process. From that scenario, there are many questions that can be asked, for instance : &quot;What is the interaction effects of a bQTL with an environmental factor?&quot;. This is a simple pairwise interaction setting and more complex scenarios can be envisaged as described in the following graph.</p><div style="text-align:center">
<img src="../assets/from_actors.png" alt="FromActors" style="width:600px;"/>
</div><p>Let us now turn to the pipeline specification for this parameter plan:</p><ul><li><code>BQTLS</code>: A path to a <code>.csv</code> file containing at least an <code>ID</code> column for each rsID and an optional <code>CHR</code> column for the chromosome on which the SNP is located.</li><li><code>TRANS_ACTORS</code>: A path prefix to a set of <code>.csv</code> files identifying different trans-acting variants. Each file has the same format as for the <code>bQTLs</code>.</li><li><code>ENVIRONMENTALS</code>: A path to a <code>.txt</code> file containing a list of environmental exposures with no header and one exposure per line. Each exposure should be available from the trait dataset.</li><li><code>EXTRA_COVARIATES</code>: A path to a <code>.txt</code> file containing a list of extra covariate variables with no header and one variable per line. Each variable should be available from the trait dataset.</li><li><code>EXTRA_CONFOUNDERS</code>: A path to a <code>.txt</code> file containing a list of extra confounding variables with no header and one variable per line. Each variable should be available from the trait dataset.</li><li><code>ORDERS</code>: A comma separated string that specifies the various interaction orders of interest. All combinations satisfying the positivity constraint will be generated. The order 1 corresponds to the Average Treatment Effect (ATE) for <code>bQTLs</code>, any higher order corresponds to the Interaction Average Treatment Effect (IATE) for the various actors. For example, in the previous scenario, assume we provided <code>ORDERS</code>=<code>1,2</code>. This would generate parameter files for the estimation of all:<ul><li>ATEs estimands for all bQTLs</li><li>IATEs estimands for all (bQTLs, xQTLs), (bQTLs, yQTLs), (bQTLs, Envs) pairs.</li></ul></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../confounding_adjustment/">« Adjusting for confounders</a><a class="docs-footer-nextpage" href="../tmle/">Specifying a Targeted Estimator »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Monday 18 March 2024 13:49">Monday 18 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
