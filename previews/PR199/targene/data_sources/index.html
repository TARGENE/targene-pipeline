<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Setting a Data Source · TarGene</title><meta name="title" content="Setting a Data Source · TarGene"/><meta property="og:title" content="Setting a Data Source · TarGene"/><meta property="twitter:title" content="Setting a Data Source · TarGene"/><meta name="description" content="Documentation for TarGene."/><meta property="og:description" content="Documentation for TarGene."/><meta property="twitter:description" content="Documentation for TarGene."/><meta property="og:url" content="https://TARGENE.github.io/targene-pipeline/targene/data_sources/"/><meta property="twitter:url" content="https://TARGENE.github.io/targene-pipeline/targene/data_sources/"/><link rel="canonical" href="https://TARGENE.github.io/targene-pipeline/targene/data_sources/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TarGene</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/setup/">Setup</a></li><li><a class="tocitem" href="../../examples/gwas/">GWAS</a></li><li><a class="tocitem" href="../../examples/phewas/">PheWAS</a></li><li><a class="tocitem" href="../../examples/interactions/">Interaction Study</a></li><li><a class="tocitem" href="../../examples/custom/">Custom Estimands</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">The TarGene Workflow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../overview/">The TarGene Workflow</a></li><li class="is-active"><a class="tocitem" href>Setting a Data Source</a><ul class="internal"><li><a class="tocitem" href="#Genetic-Data"><span>Genetic Data</span></a></li><li><a class="tocitem" href="#Traits-Dataset"><span>Traits Dataset</span></a></li></ul></li><li><a class="tocitem" href="../confounding_adjustment/">Adjusting for confounders</a></li><li><a class="tocitem" href="../study_designs/">Study Designs</a></li><li><a class="tocitem" href="../tmle/">Specifying a Targeted Estimator</a></li><li><a class="tocitem" href="../sieve_variance/">Correcting for population relatedness</a></li><li><a class="tocitem" href="../miscellaneous/">Tweaking additional behaviour</a></li><li><a class="tocitem" href="../configuration/">Configuration</a></li><li><a class="tocitem" href="../runtime_considerations/">Some Runtime considerations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">The Simulation Workflows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../simulations/overview/">The Simulations Workflows</a></li><li><a class="tocitem" href="../../simulations/null_simulation/">Null Simulation</a></li></ul></li></ul></li><li><span class="tocitem">Secondary Workflows</span><ul><li><a class="tocitem" href="../../secondary_workflows/pca/">The PCA Workflow</a></li><li><a class="tocitem" href="../../secondary_workflows/make_dataset/">The Make Dataset Workflow</a></li></ul></li><li><span class="tocitem">Developper Guide</span><ul><li><a class="tocitem" href="../../developer_guide/project_organization/">Project Organization</a></li><li><a class="tocitem" href="../../developer_guide/contribution_guide/">Contributing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li><a class="is-disabled">The TarGene Workflow</a></li><li class="is-active"><a href>Setting a Data Source</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Setting a Data Source</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TARGENE/targene-pipeline/blob/main/docs/src/targene/data_sources.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Setting-a-Data-Source"><a class="docs-heading-anchor" href="#Setting-a-Data-Source">Setting a Data Source</a><a id="Setting-a-Data-Source-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-a-Data-Source" title="Permalink"></a></h1><p>The dataset is the main ingredient manipulated by TarGene. Population Genetics datasets are typically split into a variety of files and formats. The following section describes these formats and how to input them to a TarGene run.</p><h2 id="Genetic-Data"><a class="docs-heading-anchor" href="#Genetic-Data">Genetic Data</a><a id="Genetic-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Genetic-Data" title="Permalink"></a></h2><p>TarGene currently works onlywith genotyping arrays datasets. These datasets can come in multiple formats and we currently use both <code>.bgen</code> and <code>.bed</code> formats. The <code>.bgen</code> files contain imputed variants and are provided via the <code>BGEN_FILES</code> argument. These files are used to lookup for the variants of interest in the analysis that may not have been directly genotyped. The <code>.bed</code> files are provided via the <code>BED_FILES</code> parameter and are used to extract genetic confounders (via PCA). </p><p>It is also assumed that the genotyping data is <strong>unphased</strong>. and split in chromosomes. An example for the <code>BGEN_FILES</code> and <code>BED_FILES</code> arguments are:</p><ul><li><code>BGEN_FILES=&quot;path_to_folder/imputed_chr{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22}.{bgen,sample,bgen.bgi}&quot;</code> </li><li><code>BED_FILES=&quot;path_to_folder/genotyped_chr{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22}.{bed,bim,fam}</code></li></ul><h2 id="Traits-Dataset"><a class="docs-heading-anchor" href="#Traits-Dataset">Traits Dataset</a><a id="Traits-Dataset-1"></a><a class="docs-heading-anchor-permalink" href="#Traits-Dataset" title="Permalink"></a></h2><p>In addition to genetic data, a set of traits is usually also available in a different format.</p><h3 id="Custom-Dataset"><a class="docs-heading-anchor" href="#Custom-Dataset">Custom Dataset</a><a id="Custom-Dataset-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Dataset" title="Permalink"></a></h3><p>Select with COHORT = &quot;MY_COHORT&quot; (This can be anything).</p><p>TarGene supports custom traits datasets in CSV format, that can be provided via the <code>TRAITS_DATASET</code> parameter. Please ensure the Sample IDs that identify individuals in your cohort are included as the first column of your trait data, with the column name <code>SAMPLE_ID</code>.</p><h3 id="UK-Biobank"><a class="docs-heading-anchor" href="#UK-Biobank">UK-Biobank</a><a id="UK-Biobank-1"></a><a class="docs-heading-anchor-permalink" href="#UK-Biobank" title="Permalink"></a></h3><p>Select with COHORT = &quot;UKBB&quot;, for more information on the structure of the UK-Biobank data, please refer to their <a href="https://biobank.ndph.ox.ac.uk/crystal/exinfo.cgi?src=accessing_data_guide">User Guide</a>.</p><h4 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h4><p>The trait dataset is often called the &quot;main dataset&quot; and consists of an encrypted file containing individuals&#39; trait information accessible via your project. The first option is thus to provide this dataset using the <code>TRAITS_DATASET</code> parameter. Since the data is encrypted, the pipeline will also need the encoding file that you can provide with <code>UKB_ENCODING_FILE</code>. If a &quot;typical&quot; main dataset has already been decrypted outside the TarGene workflow, one may use the <code>TRAITS_DATASET</code> as an input to the pipeline and leave the <code>UKB_ENCODING_FILE</code> argument unspecified. However, please make sure that all the fields in the <code>UKB_CONFIG</code> (see below) file described above are contained in this dataset.</p><p>!!! Tip</p><p>Since this decrypted dataset is a plain CSV file, one may build and add extra columns to it (for instance to define new phenotypes). Any column in the decrypted dataset which does not correspond to a UK-Biobank field will be considered as such.</p><p>A &quot;main dataset&quot; is typically very large and only a few traits will be of interest to a given study. To extract these traits from the dataset, a <code>UKB_CONFIG</code> YAML file must be provided. Since, writing by hand such a file for large scale study can quickly become tenuous, we provide a <a href="https://github.com/TARGENE/targene-pipeline/blob/main/assets/ukbconfig.yaml">configuration file</a> corresponding to the [GeneAtlas] study as a default and template to be modified.</p><p>The structure of the <code>UKB_CONFIG</code> YAML file consists of extraction rules that convert UK-Biobank fields to traits of interest. It contains two sections, a <code>traits</code> section and a <code>subset</code> section.</p><ul><li>The <code>traits</code> section describes the phenotypes that are either confounders, covariates or outcomes in the causal model. See below for how this is defined.</li><li>The <code>subset</code> section provides a way to filter the data based on specific traits and hence estimate conditional effects. Each element in this section corresponds to the additional condition to be met by an individual to be added in the subset.</li></ul><p>Each section is further divided in a list of <code>fields</code> items that match the UK-Biobank <a href="https://biobank.ctsu.ox.ac.uk/crystal/help.cgi?cd=data_field">data fields</a> and a list of <code>phenotypes</code> that can be extracted from these fields. This is because the content of a UK-Biobank field cannot typically be used immediately and need to be processed. For instance a UK-Biobank field may contain information about multiple phenotypes or a phenotype may be defined from multiple fields. Each phenotype in the <code>phenotypes</code> subsection of the <code>UKB_CONFIG</code> YAML file is identified by a <code>name</code> and an optional list of <code>codings</code> identifying it. Altogether, a phenotype element defines an extraction rule from a list of fields and codings.</p><p>Example of a minimal <code>UKB_CONFIG</code> YAML file:</p><pre><code class="language-yaml hljs">traits:
    - fields:
        - &quot;41202&quot;
        - &quot;41204&quot;
      phenotypes:
        - name: &quot;Chronic lower respiratory diseases&quot;
          codings:
            - &quot;J40&quot;
            - &quot;J41&quot;
            - &quot;J410&quot;
            - &quot;J411&quot;
            - &quot;J418&quot;
            - &quot;J42&quot;
            - &quot;J43&quot;
        - name: &quot;Other extrapyramidal and movement disorders&quot;
          codings:
            - &quot;G254&quot;
            - &quot;G255&quot;
            - &quot;G256&quot;
            - &quot;G258&quot;
    - fields:
        - &quot;40006&quot;
      phenotypes:
        - name: &quot;Malignant melanoma of skin&quot;
          codings:
            - &quot;C430&quot;
            - &quot;C431&quot;
            - &quot;C432&quot;
            - &quot;C433&quot;
            - &quot;C434&quot;
            - &quot;C435&quot;
            - &quot;C436&quot;
            - &quot;C437&quot;
            - &quot;C438&quot;
            - &quot;C439&quot;
    - fields:
        - &quot;1558&quot;
      phenotypes:
        - name: &quot;Alcohol intake frequency.&quot;
    - fields:
        - &quot;20117&quot;
      phenotypes:
        - name: &quot;Alcohol drinker status&quot;

subset: 
    - fields: 22001
      phenotypes:
        - name: Female
          codings: 0
    - fields: 21000
      phenotypes:
        - name: White
          codings: [1001]</code></pre><p>This configuration file restricts the analysis to white females and extract 5 traits. The first trait, &quot;Chronic lower respiratory diseases&quot; is considered &quot;true&quot; for an individual if <strong>any</strong> of the codings: (&quot;J40&quot;, &quot;J41&quot;, &quot;J410&quot;, &quot;J411&quot;, &quot;J418&quot;, &quot;J42&quot;, &quot;J43&quot;) appears in <strong>any</strong> of the fields (41202, 41204).</p><h4 id="The-Extraction-Rules"><a class="docs-heading-anchor" href="#The-Extraction-Rules">The Extraction Rules</a><a id="The-Extraction-Rules-1"></a><a class="docs-heading-anchor-permalink" href="#The-Extraction-Rules" title="Permalink"></a></h4><p>We now further describe the currently available extraction rules based on variable types. Not that a variable type is determined by the <a href="https://biobank.ndph.ox.ac.uk/ukb/schema.cgi?id=1">metadata</a> provided by the UK-Biobank and not a programmatic rule.</p><ul><li>Continuous/Count variables: Those consist in a single <code>field</code> and the extraction rule will take the first visit assessment value for that field. For instance, the &quot;Alcohol intake frequency.&quot; is simply the value from the &quot;1558-0.0&quot; column.</li><li>Ordinal data: Some variables are encoded as categorical by the UK-Biobank but an ordinal interpretation seems more appropriate. A list of such variables has been identified and hard-coded. They will be treated like continuous variables.</li><li>Categorical variables: For those variables again, the first visit assessment value for the specified field is used. An additional <code>codings</code> field can be provided. In that case the variable is turned into a indicator variable indicating whether an individual is included in the criterion given by the <code>codings</code> list. In the previous <code>subset</code> section, &quot;White&quot; is such a transformation into a binary variable. Note that we could add more elements to the list to subset on a wider population.</li><li>Categorical Arrayed variables: Some fields in the UK-Biobank consist in list of traits for individuals. This is the case for at least the fields: 41202, 41204, 20002 and 40006. For those fields it is essential to define a <code>codings</code> section that describes a trait. For instance &quot;Malignant melanoma of skin&quot; corresponds to the declaration of any of the <code>codings</code> for an individual. Moreover, some fields share the same encoding, this is the case for  41202 and 41204. In that situation it may be useful to aggregate those sources of information. For that purpose multiple fields can be provided to the <code>fields</code> section. In that scenario the declaration of any of the coding in a <code>codings</code> section for any of the <code>fields</code> will define the trait.</li></ul><h4 id="Additional-Files"><a class="docs-heading-anchor" href="#Additional-Files">Additional Files</a><a id="Additional-Files-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-Files" title="Permalink"></a></h4><p>Additional UK-Biobank required files for preprocessing and filtering are:</p><ul><li><code>QC_FILE</code>: A path to the UK-Biobank SNP quality control <a href="https://biobank.ctsu.ox.ac.uk/crystal/refer.cgi?id=1955"><code>ukb_snp_qc.txt</code></a> file.</li><li><code>UKB_WITHDRAWAL_LIST</code>: A path to the withdrawal sample list to exclude removed participants from the study.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../overview/">« The TarGene Workflow</a><a class="docs-footer-nextpage" href="../confounding_adjustment/">Adjusting for confounders »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Thursday 29 August 2024 15:09">Thursday 29 August 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
