var documenterSearchIndex = {"docs":
[{"location":"targene/runtime_considerations/#Some-Runtime-considerations","page":"Some Runtime considerations","title":"Some Runtime considerations","text":"","category":"section"},{"location":"targene/runtime_considerations/","page":"Some Runtime considerations","title":"Some Runtime considerations","text":"Runtime is discussed in detail here.","category":"page"},{"location":"targene/tmle/#Specifying-a-Targeted-Estimator","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"","category":"section"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"TarGene is a flexible procedure that does not impose any constraint on the functional form of the relationship between genetic variants, environmental variables and traits. In practice, we rely on MLJ to provide machine learning algorithms. In population genetics studies, there are two learning algorithms we need to specify:","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"E[Y|T, W, C]: The mean outcome given the treatment, confounders and extra covariates. It is commonly denoted by Q in the Targeted Learning literature. In reality, we will need one specification for continuous outcomes and one specification for binary outcomes.\np(T|W): The propensity score, which enables the targeting step of the estimation procedure. It is commonly denoted by G in the Targeted Learning literature.","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"There are two main ways to define targeted estimators, from a predefined configuration or from a custom file.","category":"page"},{"location":"targene/tmle/#Predefined-estimators","page":"Specifying a Targeted Estimator","title":"Predefined estimators","text":"","category":"section"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"A set of predefined estimators is readily available and can be accessed by using the configuration's name as the ESTIMATORS_CONFIG parameter. For instance, we provide the following:","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"G-superlearning-Q-glm\nG-superlearning-Q-glmnet\nglm-with-interactions-for-Q\nglm\nglmnet-with-interactions-for-Q\nglmnet\nsuperlearning-with-interactions-for-Q\nsuperlearning\ntuned-xgboost","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"all using TMLE as the meta statistical inference method. While these should cover most use cases, it may be useful to define a custom estimation strategy. This can be achieved by writing a small Julia file described below.","category":"page"},{"location":"targene/tmle/#Custom-estimators-from-a-file","page":"Specifying a Targeted Estimator","title":"Custom estimators from a file","text":"","category":"section"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"Writing a Julia estimators file is the most flexible way to define an estimation strategy for your study.","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"This file should simply define a NamedTuple called ESTIMATORS and listing estimators to be used for inference. For example, the following:","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"default_models = TMLE.default_models(\n  # For the estimation of E[Y|W, T]: continuous outcome\n  Q_continuous = LinearRegressor(),\n  # For the estimation of E[Y|W, T]: binary target\n  Q_binary = LogisticClassifier(lambda=0.),\n  # For the estimation of p(T| W)\n  G = LogisticClassifier(lambda=0.)\n)\n\nESTIMATORS = (\n  TMLE_weighted   = TMLEE(models=default_models, weighted=true),\n  TMLE_unweighted = TMLEE(models=default_models, weighted=false),\n  OSE             = OSE(models=default_models)\n)","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"defines three estimators:","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"A weighted-fluctuation Targeted Maximum Likelihood Estimator: TMLE\nAn unweighted-fluctuation Targeted Maximum Likelihood Estimator: TMLE\nA One-Step Estimator: OSE","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"All estimators will learn the nuisance functions Q and G with the provided models NamedTuple:","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"Q_continuous: A MLJ model used for the estimation of E[Y|T, W, C] when the outcome Y is continuous.\nQ_binary: A MLJ model used for the estimation of E[Y|T, W, C] when the outcome Y is binary.\nG: A MLJ model used for the estimation of p(T|W).","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"For the list of available models and resampling strategies, checkout the TMLECLI documentation.","category":"page"},{"location":"targene/tmle/","page":"Specifying a Targeted Estimator","title":"Specifying a Targeted Estimator","text":"For full details, on available estimators and how to specify them, visit the TMLE.jl documentation.","category":"page"},{"location":"examples/setup/#Setup","page":"Setup","title":"Setup","text":"","category":"section"},{"location":"examples/setup/","page":"Setup","title":"Setup","text":"In order to run TarGene, 3 steps need to be taken.","category":"page"},{"location":"examples/setup/#1.-Installation","page":"Setup","title":"1. Installation","text":"","category":"section"},{"location":"examples/setup/","page":"Setup","title":"Setup","text":"Install TarGene's dependencies as per the Installation section. Here I will assume that both Nextflow and Singularity are installed.","category":"page"},{"location":"examples/setup/#2.-Obtaining-the-Data","page":"Setup","title":"2. Obtaining the Data","text":"","category":"section"},{"location":"examples/setup/","page":"Setup","title":"Setup","text":"Make sure the data is available. Here I will rely on TarGene's test data located here. To obtain it, the easiest way is maybe to clone the project like so ","category":"page"},{"location":"examples/setup/","page":"Setup","title":"Setup","text":"git clone https://github.com/TARGENE/targene-pipeline","category":"page"},{"location":"examples/setup/","page":"Setup","title":"Setup","text":"and open the test/assets directory.","category":"page"},{"location":"examples/setup/","page":"Setup","title":"Setup","text":"All examples below assume that the dataset is the UK-Biobank data (we are not really using the UK-Biobank but the data was created to mimic its structure). We will use:","category":"page"},{"location":"examples/setup/","page":"Setup","title":"Setup","text":"TRAITS_DATASET (e.g. dataset.csv): A raw dataset as downloaded from the UK-Biobank's portal and containing fields data. Here it is assumed to have been decrypted.\nUKB_CONFIG (e.g. ukbconfig_gwas.yaml): A list of traits and phenotypes to be extracted from the TRAITS_DATASET.\nUKB_WITHDRAWAL_LIST (e.g. withdrawal_list.txt): A list of participants that have been withdrawn from the study.\nBED_FILES (e.g. unphased_bed/ukb_chr{1,2,3}.{bed,bim,fam}): A list of unphased plink BED files containing the genotyping data.","category":"page"},{"location":"examples/setup/#3.-Writing-a-Run-Configuration-File","page":"Setup","title":"3. Writing a Run Configuration File","text":"","category":"section"},{"location":"examples/setup/","page":"Setup","title":"Setup","text":"Write a run configuration file for your project, this can be decomposed further into 2 sub-steps:","category":"page"},{"location":"examples/setup/","page":"Setup","title":"Setup","text":"Write the part of your configuration file specific to your platform. Here we will simply use the local profile.\nWrite the part of your configuration file specific to your run. This is the topic of the remainder of the following sections.","category":"page"},{"location":"examples/setup/#Let's-Get-Started","page":"Setup","title":"Let's Get Started","text":"","category":"section"},{"location":"examples/setup/","page":"Setup","title":"Setup","text":"Steps 1., 2. and 3.1. can be time consuming if you are new to computer science but the good news is that they are typically done only once!","category":"page"},{"location":"examples/setup/","page":"Setup","title":"Setup","text":"We are now ready to look at some use cases, let's get started!","category":"page"},{"location":"examples/gwas/#GWAS","page":"GWAS","title":"GWAS","text":"","category":"section"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"Perhaps the most common study design in population genetics is the Genome-Wide Association Study (GWAS). In TarGene, a GWAS can only be performed across plink BED files. A minimalist run configuration for a GWAS in TarGene looks like the following:","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"params {\n    ESTIMANDS_CONFIG = \"gwas_config.yaml\"\n    ESTIMATORS_CONFIG = \"tmle-ose--glm\"\n\n    // UK-Biobank specific parameters\n    BED_FILES = \"unphased_bed/ukb_chr{1,2,3}.{bed,bim,fam}\"\n    UKB_CONFIG = \"ukbconfig_gwas.yaml\"\n    TRAITS_DATASET = \"dataset.csv\"\n    UKB_WITHDRAWAL_LIST = \"withdrawal_list.txt\"\n}","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"All UK-Biobank specific parameters have been described in the Setup section. The only new parameters are the ESTIMANDS_CONFIG and the ESTIMATORS_CONFIG. These parameters describe the estimands (questions of interest) and how to estimate them respectively. Since we are performing a GWAS, we are interested in the effect of all variants, across all phenotypes in the UKB_CONFIG file. Because a GWAS is expensive, this file will only contain 3 traits/phenotypes here.","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"traits:\n  - fields:\n      - \"21001\"\n    phenotypes:\n      - name: \"Body mass index (BMI)\"\n  - fields:\n      - \"728\"\n    phenotypes:\n      - name: \"Number of vehicles in household\"\n  - fields:\n      - \"1408\"\n    phenotypes:\n      - name: \"Cheese intake\"","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"In this case, Body mass index (BMI) is the outcome of interest and the Number of vehicles in household and Cheese intake traits will be used as extra predictors. The reason why this is the case is because they are described as such in the ESTIMANDS_CONFIG","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"type: gwas\n\noutcome_extra_covariates:\n  - \"Number of vehicles in household\"\n  - \"Cheese intake\"","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"Where the optional outcome_extra_covariates are variables to be used as extra predictors of the outcome (but not as confounders). Importantly, if this section had been omitted, both Number of vehicles in household and Cheese intake would be considered as outcomes by TarGene, and 3 GWASs instead of 1 would be run.","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"Finally, the ESTIMATORS_CONFIG = \"tmle-ose--glm\" says that two different estimation strategies will be used. One using the Targeted Minimum-Loss Estimator and one using the One-Step Estimator. The estimtion results can then be compared. Both methods will use a Generalized Linear Model (glm) to learn the outcome models and propensity scores.","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"The GWAS can be run as follows:","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"nextflow run https://github.com/TARGENE/targene-pipeline -r v0.11.0 -profile local","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"The successful execution will result in the creation of a results folder containing at least 3 files:","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"results.hdf5\nresults.json\nQQ.png","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"Both results.hdf5 and results.json contain the same estimation results in HDF5 and JSON formats respectively. The QQ.png is a Q-Q plot of your results that looks like the following","category":"page"},{"location":"examples/gwas/","page":"GWAS","title":"GWAS","text":"(Image: GWAS_QQ)","category":"page"},{"location":"developer_guide/project_organization/#Project-Organization","page":"Project Organization","title":"Project Organization","text":"","category":"section"},{"location":"developer_guide/project_organization/","page":"Project Organization","title":"Project Organization","text":"The TarGene project is organized around the targene-pipeline repository which contains the Nextflow workflows. However, this repository does not contain the executables that are used by the Nextflow processes. Those executables originate from complementary repositories:","category":"page"},{"location":"developer_guide/project_organization/","page":"Project Organization","title":"Project Organization","text":"TMLECLI.jl\nTargeneCore.jl\nUKBMain.jl","category":"page"},{"location":"developer_guide/project_organization/","page":"Project Organization","title":"Project Organization","text":"The following diagram presents a high level perspective of the project's organization and dependence structure.","category":"page"},{"location":"developer_guide/project_organization/","page":"Project Organization","title":"Project Organization","text":"(Image: TarGene Organization)","category":"page"},{"location":"simulations/overview/#The-Simulations-Workflows","page":"The Simulations Workflows","title":"The Simulations Workflows","text":"","category":"section"},{"location":"simulations/overview/","page":"The Simulations Workflows","title":"The Simulations Workflows","text":"The asymptotic performance of semi-parametric estimators is theoretically optimal. However, in practice, asymptotic regimes are not necessarily achieved even for large sample sizes because some events are extremely rare. This is particularly prevalent in population genetics where some genetic variants and traits are found in less than 1 of individuals. In the absence of finite sample guarantees, simulation studies provide an effective way to validate statistical methods. An ideal simulation would both yield ground-truth values for the causal effects of interest and be representative of real data. In TarGene, we propose two types of simulations to analyse the performance of semi-parametric estimators. ","category":"page"},{"location":"simulations/overview/","page":"The Simulations Workflows","title":"The Simulations Workflows","text":"The first type of simulations, called the Null Simulation, aims at analysing the behaviour of the estimators when the Null-Hypothesis of \"no effect\" is true. The rationale behind this simulation is that most genetic variants are believed to have no effect, it is thus of particular importance that the type 1 error rate be controlled appropriately. ","category":"page"},{"location":"simulations/overview/","page":"The Simulations Workflows","title":"The Simulations Workflows","text":"The second type of simulations, called the Realistic Simulation, fits the generating process using data-adaptive flexible machine-learning generative models. As such, it retains important features of the true generating process, but also provides ground truth values.","category":"page"},{"location":"targene/data_sources/#Setting-a-Data-Source","page":"Setting a Data Source","title":"Setting a Data Source","text":"","category":"section"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"The dataset is the main ingredient manipulated by TarGene. Population Genetics datasets are typically split into a variety of files and formats. The following section describes these formats and how to input them to a TarGene run.","category":"page"},{"location":"targene/data_sources/#Genetic-Data","page":"Setting a Data Source","title":"Genetic Data","text":"","category":"section"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"TarGene currently works onlywith genotyping arrays datasets. These datasets can come in multiple formats and we currently use both .bgen and .bed formats. The .bgen files contain imputed variants and are provided via the BGEN_FILES argument. These files are used to lookup for the variants of interest in the analysis that may not have been directly genotyped. The .bed files are provided via the BED_FILES parameter and are used to extract genetic confounders (via PCA). ","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"It is also assumed that the genotyping data is unphased. and split in chromosomes. An example for the BGEN_FILES and BED_FILES arguments are:","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"BGEN_FILES=\"path_to_folder/imputed_chr{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22}.{bgen,sample,bgen.bgi}\" \nBED_FILES=\"path_to_folder/genotyped_chr{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22}.{bed,bim,fam}","category":"page"},{"location":"targene/data_sources/#Traits-Dataset","page":"Setting a Data Source","title":"Traits Dataset","text":"","category":"section"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"In addition to genetic data, a set of traits is usually also available in a different format.","category":"page"},{"location":"targene/data_sources/#Custom-Dataset","page":"Setting a Data Source","title":"Custom Dataset","text":"","category":"section"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"Select with COHORT = \"MY_COHORT\" (This can be anything).","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"TarGene supports custom traits datasets in CSV format, that can be provided via the TRAITS_DATASET parameter. Please ensure the Sample IDs that identify individuals in your cohort are included as the first column of your trait data, with the column name SAMPLE_ID.","category":"page"},{"location":"targene/data_sources/#UK-Biobank","page":"Setting a Data Source","title":"UK-Biobank","text":"","category":"section"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"Select with COHORT = \"UKBB\", for more information on the structure of the UK-Biobank data, please refer to their User Guide.","category":"page"},{"location":"targene/data_sources/#Overview","page":"Setting a Data Source","title":"Overview","text":"","category":"section"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"The trait dataset is often called the \"main dataset\" and consists of an encrypted file containing individuals' trait information accessible via your project. The first option is thus to provide this dataset using the TRAITS_DATASET parameter. Since the data is encrypted, the pipeline will also need the encoding file that you can provide with UKB_ENCODING_FILE. If a \"typical\" main dataset has already been decrypted outside the TarGene workflow, one may use the TRAITS_DATASET as an input to the pipeline and leave the UKB_ENCODING_FILE argument unspecified. However, please make sure that all the fields in the UKB_CONFIG (see below) file described above are contained in this dataset.","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"!!! Tip","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"Since this decrypted dataset is a plain CSV file, one may build and add extra columns to it (for instance to define new phenotypes). Any column in the decrypted dataset which does not correspond to a UK-Biobank field will be considered as such.","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"A \"main dataset\" is typically very large and only a few traits will be of interest to a given study. To extract these traits from the dataset, a UKB_CONFIG YAML file must be provided. Since, writing by hand such a file for large scale study can quickly become tenuous, we provide a configuration file corresponding to the [GeneAtlas] study as a default and template to be modified.","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"The structure of the UKB_CONFIG YAML file consists of extraction rules that convert UK-Biobank fields to traits of interest. It contains two sections, a traits section and a subset section.","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"The traits section describes the phenotypes that are either confounders, covariates or outcomes in the causal model. See below for how this is defined.\nThe subset section provides a way to filter the data based on specific traits and hence estimate conditional effects. Each element in this section corresponds to the additional condition to be met by an individual to be added in the subset.","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"Each section is further divided in a list of fields items that match the UK-Biobank data fields and a list of phenotypes that can be extracted from these fields. This is because the content of a UK-Biobank field cannot typically be used immediately and need to be processed. For instance a UK-Biobank field may contain information about multiple phenotypes or a phenotype may be defined from multiple fields. Each phenotype in the phenotypes subsection of the UKB_CONFIG YAML file is identified by a name and an optional list of codings identifying it. Altogether, a phenotype element defines an extraction rule from a list of fields and codings.","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"Example of a minimal UKB_CONFIG YAML file:","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"traits:\n    - fields:\n        - \"41202\"\n        - \"41204\"\n      phenotypes:\n        - name: \"Chronic lower respiratory diseases\"\n          codings:\n            - \"J40\"\n            - \"J41\"\n            - \"J410\"\n            - \"J411\"\n            - \"J418\"\n            - \"J42\"\n            - \"J43\"\n        - name: \"Other extrapyramidal and movement disorders\"\n          codings:\n            - \"G254\"\n            - \"G255\"\n            - \"G256\"\n            - \"G258\"\n    - fields:\n        - \"40006\"\n      phenotypes:\n        - name: \"Malignant melanoma of skin\"\n          codings:\n            - \"C430\"\n            - \"C431\"\n            - \"C432\"\n            - \"C433\"\n            - \"C434\"\n            - \"C435\"\n            - \"C436\"\n            - \"C437\"\n            - \"C438\"\n            - \"C439\"\n    - fields:\n        - \"1558\"\n      phenotypes:\n        - name: \"Alcohol intake frequency.\"\n    - fields:\n        - \"20117\"\n      phenotypes:\n        - name: \"Alcohol drinker status\"\n\nsubset: \n    - fields: 22001\n      phenotypes:\n        - name: Female\n          codings: 0\n    - fields: 21000\n      phenotypes:\n        - name: White\n          codings: [1001]","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"This configuration file restricts the analysis to white females and extract 5 traits. The first trait, \"Chronic lower respiratory diseases\" is considered \"true\" for an individual if any of the codings: (\"J40\", \"J41\", \"J410\", \"J411\", \"J418\", \"J42\", \"J43\") appears in any of the fields (41202, 41204).","category":"page"},{"location":"targene/data_sources/#The-Extraction-Rules","page":"Setting a Data Source","title":"The Extraction Rules","text":"","category":"section"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"We now further describe the currently available extraction rules based on variable types. Not that a variable type is determined by the metadata provided by the UK-Biobank and not a programmatic rule.","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"Continuous/Count variables: Those consist in a single field and the extraction rule will take the first visit assessment value for that field. For instance, the \"Alcohol intake frequency.\" is simply the value from the \"1558-0.0\" column.\nOrdinal data: Some variables are encoded as categorical by the UK-Biobank but an ordinal interpretation seems more appropriate. A list of such variables has been identified and hard-coded. They will be treated like continuous variables.\nCategorical variables: For those variables again, the first visit assessment value for the specified field is used. An additional codings field can be provided. In that case the variable is turned into a indicator variable indicating whether an individual is included in the criterion given by the codings list. In the previous subset section, \"White\" is such a transformation into a binary variable. Note that we could add more elements to the list to subset on a wider population.\nCategorical Arrayed variables: Some fields in the UK-Biobank consist in list of traits for individuals. This is the case for at least the fields: 41202, 41204, 20002 and 40006. For those fields it is essential to define a codings section that describes a trait. For instance \"Malignant melanoma of skin\" corresponds to the declaration of any of the codings for an individual. Moreover, some fields share the same encoding, this is the case for  41202 and 41204. In that situation it may be useful to aggregate those sources of information. For that purpose multiple fields can be provided to the fields section. In that scenario the declaration of any of the coding in a codings section for any of the fields will define the trait.","category":"page"},{"location":"targene/data_sources/#Additional-Files","page":"Setting a Data Source","title":"Additional Files","text":"","category":"section"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"Additional UK-Biobank required files for preprocessing and filtering are:","category":"page"},{"location":"targene/data_sources/","page":"Setting a Data Source","title":"Setting a Data Source","text":"QC_FILE: A path to the UK-Biobank SNP quality control ukb_snp_qc.txt file.\nUKB_WITHDRAWAL_LIST: A path to the withdrawal sample list to exclude removed participants from the study.","category":"page"},{"location":"examples/interactions/#Interaction-Study","page":"Interaction Study","title":"Interaction Study","text":"","category":"section"},{"location":"examples/interactions/","page":"Interaction Study","title":"Interaction Study","text":"In TarGene you can investigate the interacting effects between genetic variants and between genetic variants and the environment up to any order (GxG, GxE, GxGxG, ...). However, the computational complexity associated with interaction testing grows exponentially. Interaction studies are thus very often targeted, for instance towards a specific transcription factor TF. For this transcription factor, multiple variants may have been identified because they are believed to play different roles. In TarGene such a scenario can be encoded via the group mode of the ESTIMANDS_CONFIG file. An example is more informative than a long description. Let's save the following content to a \"newinteractionconfig.yaml\" file.","category":"page"},{"location":"examples/interactions/","page":"Interaction Study","title":"Interaction Study","text":"type: groups\n\nestimands:\n  - type: AIE\n    orders: [2, 3]\n\nvariants:\n  TF:\n    variants_1:\n      - \"1:238411180:T:C\"\n      - \"3:3502414:T:C\"\n    variants_2:\n      - \"2:14983:G:A\"\n\nextra_treatments:\n  - \"Cheese intake\"\n\noutcome_extra_covariates:\n  - \"Number of vehicles in household\"","category":"page"},{"location":"examples/interactions/","page":"Interaction Study","title":"Interaction Study","text":"The estimands section describes the types of estimands we are interested in, here Average Interaction Effects: AIE. We would like to scan both orders 2 and 3.","category":"page"},{"location":"examples/interactions/","page":"Interaction Study","title":"Interaction Study","text":"The variants section contains groups of variants for which the interactions will be generated independently. Here there is only one group called TF, and it contains two subgroups: variants_1 and variants_2. This means that combinations of variants_1 and variants_2 will define the interactions under investigation. Here they are simply (\"1:238411180:T:C\", \"2:14983:G:A\") and (\"3:3502414:T:C\", \"2:14983:G:A\"). Why did we set the interaction orders to be both 2 and 3 since only pairwise interactions can be generated here?","category":"page"},{"location":"examples/interactions/","page":"Interaction Study","title":"Interaction Study","text":"This is because the extra_treatments section can list additional environmental variables, thus increasing the potential interaction order. In this case, there is one: \"Cheese intake\". This means that additional pairwise interactions will be generated: (\"1:238411180:T:C\", \"Cheese intake\"), (\"2:14983:G:A\", \"Cheese intake\") and (\"3:3502414:T:C\", \"Cheese intake\"). But also the following order 3 interactions: (\"1:238411180:T:C\", \"2:14983:G:A\", \"Cheese intake\") and (\"3:3502414:T:C\", \"2:14983:G:A\", \"Cheese intake\").","category":"page"},{"location":"examples/interactions/","page":"Interaction Study","title":"Interaction Study","text":"Finally, the outcome_extra_covariates describes additional variables predictive of the outcome, but that do not confound the effect of treatment variables (variants and extra_treatments).","category":"page"},{"location":"examples/interactions/","page":"Interaction Study","title":"Interaction Study","text":"Importantly, all traits variables in the TRAITS_DATASET that are not listed as either outcome_extra_covariates or extra_treatments will be considered as outcome variables.","category":"page"},{"location":"examples/interactions/","page":"Interaction Study","title":"Interaction Study","text":"We will now point to this newly created ESTIMANDS_CONFIG in our nextflow.config file:","category":"page"},{"location":"examples/interactions/","page":"Interaction Study","title":"Interaction Study","text":"params {\n    ESTIMANDS_CONFIG = \"new_interaction_config.yaml\"\n\n    // UK-Biobank specific parameters\n    BED_FILES = \"unphased_bed/ukb_chr{1,2,3}.{bed,bim,fam}\"\n    UKB_CONFIG = \"ukbconfig_small.yaml\"\n    TRAITS_DATASET = \"dataset.csv\"\n    UKB_WITHDRAWAL_LIST = \"withdrawal_list.txt\"\n}","category":"page"},{"location":"examples/interactions/","page":"Interaction Study","title":"Interaction Study","text":"As usual, the pipeline can then be run as follows:","category":"page"},{"location":"examples/interactions/","page":"Interaction Study","title":"Interaction Study","text":"nextflow run https://github.com/TARGENE/targene-pipeline -r v0.11.0 -profile local","category":"page"},{"location":"targene/miscellaneous/#Tweaking-additional-behaviour","page":"Tweaking additional behaviour","title":"Tweaking additional behaviour","text":"","category":"section"},{"location":"targene/miscellaneous/","page":"Tweaking additional behaviour","title":"Tweaking additional behaviour","text":"Further Nextflow parameter affecting the behaviour of the pipeline but that does not fit in any previously described category is listed here:","category":"page"},{"location":"targene/miscellaneous/","page":"Tweaking additional behaviour","title":"Tweaking additional behaviour","text":"CALL_THRESHOLD (optional, default: 0.9): For putative causal variants (listed in the parameter files described in the Study Designs section). If the individual's maximum allele's probability is greater than the threshold, then it is called, otherwise it is considered missing. Set to null to simply call the allele with the highest probability.\nBATCH_SIZE (optional, default: 400): The set of estimands to be estimated is batched and the TMLE processes will run in parallel across batches on your platform.\nSVP (optional, default: false): To activate Sieve Variance Plateau correction. If set to true, KEEP_IC will automatically be set to true as well.\nKEEP_IC (optional, default: false): For all estimands with a p-value below PVAL_THRESHOLD, the influence curve is saved.\nNB_SVP_ESTIMATORS (optional, default: 100): The number of estimators in Sieve Variance Plateau.\nOUTDIR (optional, default: \"results\"): Output directory","category":"page"},{"location":"secondary_workflows/make_dataset/#The-Make-Dataset-Workflow","page":"The Make Dataset Workflow","title":"The Make Dataset Workflow","text":"","category":"section"},{"location":"secondary_workflows/make_dataset/","page":"The Make Dataset Workflow","title":"The Make Dataset Workflow","text":"This workflow extracts an aggregated dataset containing traits (TRAITS_DATASET), genetic confounders (NB_PCS) and genetic variants (VARIANTS_LIST) in an Arrow tabular format.","category":"page"},{"location":"secondary_workflows/make_dataset/","page":"The Make Dataset Workflow","title":"The Make Dataset Workflow","text":"(Image: Make Dataset)","category":"page"},{"location":"secondary_workflows/make_dataset/#Example-Run-Command","page":"The Make Dataset Workflow","title":"Example Run Command","text":"","category":"section"},{"location":"secondary_workflows/make_dataset/","page":"The Make Dataset Workflow","title":"The Make Dataset Workflow","text":"nextflow run https://github.com/TARGENE/targene-pipeline/ -r TAG -entry MAKE_DATASET -profile P -resume","category":"page"},{"location":"secondary_workflows/make_dataset/#List-Of-Workflow-Arguments","page":"The Make Dataset Workflow","title":"List Of Workflow Arguments","text":"","category":"section"},{"location":"secondary_workflows/make_dataset/","page":"The Make Dataset Workflow","title":"The Make Dataset Workflow","text":"VARIANTS_LIST (required): A text file (one rsid per line) specifying the variants of interest.\nBGEN_FILES (required): Path to imputed BGEN files from which the variants in VARIANTS_LIST will be extracted.\nNB_PCS (optional, default: 6): The number of PCA components to extract.\nBED_FILES (required): Path expression to PLINK BED files.\nCOHORT (optional: \"UKBB\"): Current default for this is UKBB. If set to a value other than UKBB, this will not run UKBB-specific trait extraction.\nTRAITS_DATASET (required): Path to a traits dataset. If you are running this for a non-UKBB cohort, your sample IDs must be specified in the first column of this CSV file, with the column name SAMPLE_ID.\nFLASHPCA_EXCLUSION_REGIONS (optional, default: assets/exclusionregionshg19.txt): A path to the flashpca special exclusion regions.\nMAF_THRESHOLD (optional, default: 0.01): Only variants with that minor allele frequency are considered\nLD_BLOCKS (optional): A path to pre-identified linkage disequlibrium blocks to be removed from the BED files. It is good practice to specify LD_BLOCKS, as it will remove SNPs correlated with your variants-of-interest before running PCA.","category":"page"},{"location":"secondary_workflows/make_dataset/","page":"The Make Dataset Workflow","title":"The Make Dataset Workflow","text":"If the COHORT argument is set to UKBB:","category":"page"},{"location":"secondary_workflows/make_dataset/","page":"The Make Dataset Workflow","title":"The Make Dataset Workflow","text":"UKB_CONFIG (required): YAML configuration file describing which traits should be extracted and how the population should be subsetted.\nUKB_ENCODING_FILE (optional): If the TRAITS_DATASET is encrypted, an encoding file must be provided.\nUKB_WITHDRAWAL_LIST (optional): List of participants withdrawn from the study.\nQC_FILE (optional): Genotyping quality control file from the UK-Biobank study.","category":"page"},{"location":"targene/overview/#The-TarGene-Workflow","page":"The TarGene Workflow","title":"The TarGene Workflow","text":"","category":"section"},{"location":"targene/overview/#Overview","page":"The TarGene Workflow","title":"Overview","text":"","category":"section"},{"location":"targene/overview/","page":"The TarGene Workflow","title":"The TarGene Workflow","text":"The main purpose of the TarGene workflow is to estimate a wide variety of genetic effect sizes using the Targeted Learning framework. Contrary to a GWAS setting, this workflow assumes that a set of genetic variants and/or environmental variables have been pre-identified and are provided as an input to the workflow. The workflow can be roughly decomposed into three main steps:","category":"page"},{"location":"targene/overview/","page":"The TarGene Workflow","title":"The TarGene Workflow","text":"In the first step, all data sources are brought together to build:\nAn aggregated dataset containing all variables in an Arrow tabular format.\nA set of estimands files that contain all the effect sizes to be estimated.\nIn the second step all effect sizes are estimated via Targeted Learning in a parallel manner across the generated estimands files. Results are then merged into a single file.\nFinally, an optional Sieve Variance Plateau correction of the variance estimates is performed.","category":"page"},{"location":"targene/overview/","page":"The TarGene Workflow","title":"The TarGene Workflow","text":"An overview of the workflow is presented in the following diagram.","category":"page"},{"location":"targene/overview/","page":"The TarGene Workflow","title":"The TarGene Workflow","text":"(Image: TarGene Workflow High Level)","category":"page"},{"location":"targene/overview/#Example-Run-Command","page":"The TarGene Workflow","title":"Example Run Command","text":"","category":"section"},{"location":"targene/overview/","page":"The TarGene Workflow","title":"The TarGene Workflow","text":"nextflow run https://github.com/TARGENE/targene-pipeline/ -r TAG -entry TARGENE -profile P -resume","category":"page"},{"location":"targene/overview/","page":"The TarGene Workflow","title":"The TarGene Workflow","text":"We now describe step by step how to setup a TarGene run configuration.","category":"page"},{"location":"secondary_workflows/pca/#The-PCA-Workflow","page":"The PCA Workflow","title":"The PCA Workflow","text":"","category":"section"},{"location":"secondary_workflows/pca/","page":"The PCA Workflow","title":"The PCA Workflow","text":"This workflow computes the number of specified principal components (NB_PCS) using flashpca from a set of genetic files in BED format (BED_FILES) and a trait dataset specifying the population of interest (TRAITS_DATASET).","category":"page"},{"location":"secondary_workflows/pca/#Example-Run-Command","page":"The PCA Workflow","title":"Example Run Command","text":"","category":"section"},{"location":"secondary_workflows/pca/","page":"The PCA Workflow","title":"The PCA Workflow","text":"nextflow run https://github.com/TARGENE/targene-pipeline/ -r TAG -entry PCA -profile P -resume","category":"page"},{"location":"secondary_workflows/pca/#List-Of-Workflow-Arguments","page":"The PCA Workflow","title":"List Of Workflow Arguments","text":"","category":"section"},{"location":"secondary_workflows/pca/","page":"The PCA Workflow","title":"The PCA Workflow","text":"NB_PCS (optional, default: 6): The number of PCA components to extract.\nBED_FILES (required): Path expression to PLINK BED files.\nCOHORT (optional: \"UKBB\"): Current default for this is UKBB. If set to a value other than UKBB, this will not run UKBB-specific trait extraction.\nTRAITS_DATASET (required): Path to a traits dataset. If you are running this for a non-UKBB cohort, your sample IDs must be specified in the first column of this CSV file, with the column name SAMPLE_ID.\nFLASHPCA_EXCLUSION_REGIONS (optional, default: assets/exclusionregionshg19.txt): A path to the flashpca special exclusion regions.\nMAF_THRESHOLD (optional, default: 0.01): Only variants with that minor allele frequency are considered\nLD_BLOCKS (optional): A path to pre-identified linkage disequlibrium blocks to be removed from the BED files. It is good practice to specify LD_BLOCKS, as it will remove SNPs correlated with your variants-of-interest before running PCA.","category":"page"},{"location":"secondary_workflows/pca/","page":"The PCA Workflow","title":"The PCA Workflow","text":"If the COHORT argument is set to UKBB:","category":"page"},{"location":"secondary_workflows/pca/","page":"The PCA Workflow","title":"The PCA Workflow","text":"UKB_CONFIG (required): YAML configuration file describing which traits should be extracted and how the population should be subsetted.\nUKB_ENCODING_FILE (optional): If the TRAITS_DATASET is encrypted, an encoding file must be provided.\nUKB_WITHDRAWAL_LIST (optional): List of participants withdrawn from the study.\nQC_FILE (optional): Genotyping quality control file from the UK-Biobank study.","category":"page"},{"location":"targene/confounding_adjustment/#Adjusting-for-confounders","page":"Adjusting for confounders","title":"Adjusting for confounders","text":"","category":"section"},{"location":"targene/confounding_adjustment/","page":"Adjusting for confounders","title":"Adjusting for confounders","text":"To account for potential confounding effect due to population stratification, we extract principal components from the genetic data using flashpca. We follow the recommended procedure for this tool which implies some preprocessing and filtering. The associated arguments are as follows:","category":"page"},{"location":"targene/confounding_adjustment/","page":"Adjusting for confounders","title":"Adjusting for confounders","text":"LD_BLOCKS (optional): A path to pre-identified linkage desequlibrium blocks around the variants that will be queried for causal effect estimation. Those LD blocks will be removed from the data.\nFLASHPCA_EXCLUSION_REGIONS (required, default: assets/exclusionregionshg19.txt): A path to the flashpca special exclusion regions which is provided in their repository.\nMAF_THRESHOLD (optional, default: 0.01): Only variants with that minor allele frequency are used to compute principal components.\nNB_PCS (optional, default: 6): The number of PCA components to extract.","category":"page"},{"location":"developer_guide/contribution_guide/#Contributing","page":"Contributing","title":"Contributing","text":"","category":"section"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"Contributions, whether bug fixes, new features or documentation improvements are very welcome!","category":"page"},{"location":"developer_guide/contribution_guide/#Raise-an-issue","page":"Contributing","title":"Raise an issue","text":"","category":"section"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"In order to discuss and track the evolution of the project, please first raise an issue on the targene-pipeline repository. If a change is agreed upon, the discussion should identify the relevant repositories that are concerned by the change and open an issue on each of the repository. For instance, if one wishes to improve the extraction of traits from the UK-Biobank, the UKBMain.jl would surely be impacted and a new release for that package necessary.","category":"page"},{"location":"developer_guide/contribution_guide/#Workflow","page":"Contributing","title":"Workflow","text":"","category":"section"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"Following our previous UKBMain.jl example, there are two repositories that need to be updated, the current workflow is as follows:","category":"page"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"Develop\nUKBMain.jl\nCreate a new git branch for your change\nDevelop and test\nRelease an image for your branch by selecting it after clicking the Run workflow button. If the tests pass, a new docker image will be generated and hosted on Docker hub with your branch's name (see Note on Docker images).\ntargene-pipeline\nCreate a new git branch for your change\nFor each Nextflow process using the UKBMain.jl's docker image, update to the branch's image name.\nDevelop further required changes and run/add the tests (see Note on the pipeline's tests).\nReview: When everything is working, ask for a review\nRelease UKBMain.jl:\nMerge your branch into main\nCreate a new Github release following semantic versioning, this will create a new docker image with your release name.\nRelease TarGene\nFor each Nextflow process using the UKBMain.jl's docker image, update to the released image name (as before).\nCreate a new Github release following semantic versioning","category":"page"},{"location":"developer_guide/contribution_guide/#Note-on-Docker-images","page":"Contributing","title":"Note on Docker images","text":"","category":"section"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"Currently, all TarGene building blocks (executables) are provided as docker images. The following table provides a map linking each TarGene repository to the associated Docker image tags.","category":"page"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"Repository Docker tag\nTargeneCore.jl tl-core\nUKBMain.jl ukbmain\nTMLECLI.jl targeted-estimation","category":"page"},{"location":"developer_guide/contribution_guide/#Note-on-the-pipeline's-tests","page":"Contributing","title":"Note on the pipeline's tests","text":"","category":"section"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"The pipeline is automatically tested for every push/pull-request against a variety of tasks listed in the testrun section of the CI YAML file. To add a new test, you thus need to add a testrun in this section and a corresponding Julia file in the test folder.","category":"page"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"In can also be useful to run the tests locally for debugging. This can be done if you have Nextflow, Julia and Singularity installed and requires a Linux machine. If you have instantiated the test project, a test can be fully run like so:","category":"page"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"julia --project=test --startup-file=no test/TESTFILE -profile local -resume","category":"page"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"Alternatively, within the Julia REPL you can manually run the code sequentially.","category":"page"},{"location":"developer_guide/contribution_guide/#Updating-the-Documentation","page":"Contributing","title":"Updating the Documentation","text":"","category":"section"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"The documentation is built and deployed using Documenter.jl. It only relies on Markdown files which can simply be edited.","category":"page"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"However, it may be useful to see how your changes will be reflected within the documentation as you are working in real time. For that, you can use the following workflow (steps 1 and 2 are done only once):","category":"page"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"Install Julia\nFrom the Julia REPL, install in the main Julia environment the LiveServer package: add LiveServer.\nIn the project directory (targene-pipeline) run: julia --startup-file=no --project=docs -e'using LiveServer; servedocs()'","category":"page"},{"location":"developer_guide/contribution_guide/","page":"Contributing","title":"Contributing","text":"The documentation should be accessible in your browser at http://localhost:8000/.","category":"page"},{"location":"examples/custom/#Custom-Estimands","page":"Custom Estimands","title":"Custom Estimands","text":"","category":"section"},{"location":"targene/sieve_variance/#Correcting-for-population-relatedness","page":"Correcting for population relatedness","title":"Correcting for population relatedness","text":"","category":"section"},{"location":"targene/sieve_variance/","page":"Correcting for population relatedness","title":"Correcting for population relatedness","text":"If the i.i.d. (independent and identically distributed) hypothesis is not satisfied, most of the traditional statistical inference theory falls apart. This is typically possible in population genetics where a study may contain related individuals. Here we leverage a non-parametric method called Sieve Variance Plateau (SVP) estimation. The hypothesis is that the dependence between individuals is sufficiently small, so that our targeted estimator will still be asymptotically unbiased, but its variance will be under estimated. In brief, the SVP estimator computes a variance estimate for a range of thresholds 𝜏, by considering individuals to be genetically independent if their genetic distance exceeds 𝜏. The genetic distance between a pair of individuals (𝑖, 𝑗) equals 1 − GRM𝑖,𝑗 , i.e., one minus their genetic relatedness value. As the distance threshold 𝜏 increases, fewer individuals are assumed to be genetically independent. For instance, the estimate corresponding to a distance of 𝜏 = 0 corresponds to the i.i.d. hypothesis, while a distance of 𝜏 = 1 incorporates pairs of individuals who are not genetically correlated. TarGene varies the threshold 𝜏 from 0 to 1 and fits a curve to the corresponding variance estimates. The maximum of this curve is the most conservative estimate of the variance estimator and constitutes our corrected variance estimator.","category":"page"},{"location":"targene/sieve_variance/","page":"Correcting for population relatedness","title":"Correcting for population relatedness","text":"The following arguments can be changed to control the behaviour of the pipeline:","category":"page"},{"location":"targene/sieve_variance/","page":"Correcting for population relatedness","title":"Correcting for population relatedness","text":"SVP (default: false): Must be set to true to enable variance adjustement.\nESTIMATOR_KEY (default: TMLE): The estimator from the ESTIMATORS_CONFIG that will be used for sieve variance plateau adjustment.\nGRM_NSPLITS (default: 100): This is a purely computational argument. The GRM is typically very large and splitting enables a good memory/parallelization tradeoff.\nMAX_SVP_THRESHOLD (default: 0.8): Controls the maximum genetic distance considered.\nNB_SVP_ESTIMATORS (default: 0): Controls the number of points in the interval [0, MAX_SVP_THRESHOLD]. If 0, the Sieve Variance Plateau method will not be applied.\nPVAL_THRESHOLD (default: 0.05): Only estimates with a p-value lower than PVAL_THRESHOLD will be considered for SVP correction. This is because SVP will only increase the variance of the estimator.","category":"page"},{"location":"simulations/null_simulation/#Null-Simulation","page":"Null Simulation","title":"Null Simulation","text":"","category":"section"},{"location":"simulations/null_simulation/","page":"Null Simulation","title":"Null Simulation","text":"The goal of the Null Generating Process is to result in the theoretical Null hypothesis of \"no effect\". The main rationale behind this simulation is that most of the genome is still believed to be irrelevant. It is thus of particular importance that the proposed semi-parametric estimators are not too sensitive to noise in order to control the false discovery rate. Since we are interested in the effects of genetic variants on traits, the data generating process must satisfy: forall j Y indep V_j, where Y is a given trait. In practice, we enforce an even stronger condition, where all variables are pairwise independent. This is done by drawing independently n samples with replacement from the empirical marginal distribution of each variable. The only exception is that (PCs C) are sampled jointly. This generating process hence preserves many characteristics of the original dataset,  while resulting in the Null hypothesis.","category":"page"},{"location":"simulations/null_simulation/","page":"Null Simulation","title":"Null Simulation","text":"(Image: Null Simulation)","category":"page"},{"location":"targene/configuration/#Configuration","page":"Configuration","title":"Configuration","text":"","category":"section"},{"location":"targene/configuration/#Main-Outputs","page":"Configuration","title":"Main Outputs","text":"","category":"section"},{"location":"targene/configuration/","page":"Configuration","title":"Configuration","text":"The workflow will produce the following main outputs in the output directory (OUTDIR, defaults to results):","category":"page"},{"location":"targene/configuration/","page":"Configuration","title":"Configuration","text":"An HDF5 file containing estimation results (HDF5_OUTPUT, default: results.hdf5)\nAn optional JSON file containing estimation results (JSON_OUTPUT)\nAn optional svp.hdf5 containing Sieve Variance Plateau corrected variance estimates.\nA Quantile-Quantile summary plot: QQ.png","category":"page"},{"location":"targene/configuration/#Arguments","page":"Configuration","title":"Arguments","text":"","category":"section"},{"location":"targene/configuration/","page":"Configuration","title":"Configuration","text":"ESTIMATORS_CONFIG: Estimator name or Julia file containing the description of the Targeted Estimators to use. To be consistent it should match the argument provided to the previous TarGene run.\nBGEN_FILES: Path to imputed BGEN files from which the variants in VARIANTS_LIST will be extracted.\nBED_FILES: Path expression to PLINK BED files.\nTRAITS_DATASET: Path to a traits dataset. If you are running this for a non-UKBB cohort, your sample IDs must be specified in the first column of this CSV file, with the column name SAMPLE_ID.","category":"page"},{"location":"targene/configuration/#Main-Options","page":"Configuration","title":"Main Options","text":"","category":"section"},{"location":"targene/configuration/","page":"Configuration","title":"Configuration","text":"STUDY_DESIGN (default: CUSTOM): How genetic variants and effect sizes are specified. See the study design section.\nCOHORT (default: \"UKBB\"): Current default for this is UKBB. If set to a value other than UKBB, this will not run UKBB-specific trait extraction.\nPOSITIVITY_CONSTRAINT (default: 0.01): When the list of estimands is generated or validated. Treatment variables' rarest configuration should have at least that frequency. For example if the treatment variables are two variants with minor allele A and T respectively. The rarest configuration will be (AA, TT) and should have a frequency of at least POSITIVITY_CONSTRAINT.\nNB_PCS (default: 6): The number of PCA components to extract.\nSVP (default: false): Whether Sieve Variance Plateau correction should be performed.\nFLASHPCA_EXCLUSION_REGIONS (default: assets/exclusionregionshg19.txt): A path to the flashpca special exclusion regions.\nMAF_THRESHOLD (default: 0.01): Only variants with that minor allele frequency are considered\nLD_BLOCKS: A path to pre-identified linkage disequilibrium blocks to be removed from the BED files. It is good practice to specify LD_BLOCKS, as it will remove SNPs correlated with your variants-of-interest before running PCA.","category":"page"},{"location":"targene/configuration/#If-COHORTUKBB-(default)","page":"Configuration","title":"If COHORT=UKBB (default)","text":"","category":"section"},{"location":"targene/configuration/","page":"Configuration","title":"Configuration","text":"UKB_CONFIG (default: assets/ukbconfig.yaml): YAML configuration file describing which traits should be extracted and how the population should be subsetted.\nUKB_ENCODING_FILE: If the TRAITS_DATASET is encrypted, an encoding file must be provided.\nUKB_WITHDRAWAL_LIST: List of participants withdrawn from the study.\nQC_FILE: Genotyping quality control file from the UK-Biobank study.","category":"page"},{"location":"targene/configuration/#If-STUDY_DESIGNCUSTOM-(default)","page":"Configuration","title":"If STUDY_DESIGN=CUSTOM (default)","text":"","category":"section"},{"location":"targene/configuration/","page":"Configuration","title":"Configuration","text":"ESTIMANDS_CONFIG: YAML configuration file describing the effect sizes of interest, see the custom study design section","category":"page"},{"location":"targene/configuration/#If-STUDY_DESIGNALLELE_INDEPENDENT","page":"Configuration","title":"If STUDY_DESIGN=ALLELE_INDEPENDENT","text":"","category":"section"},{"location":"targene/configuration/","page":"Configuration","title":"Configuration","text":"ESTIMANDS_CONFIG: YAML configuration file describing the effect sizes of interest, see the allele independent section.","category":"page"},{"location":"targene/configuration/#If-STUDY_DESIGNFROM_ACTORS","page":"Configuration","title":"If STUDY_DESIGN=FROM_ACTORS","text":"","category":"section"},{"location":"targene/configuration/","page":"Configuration","title":"Configuration","text":"BQTLS: A CSV file containing binding quantitative trait loci (bQTLs). If multiple transcription factors (TFs) are included in a single run, you must include a column called TF, which specifies the TF associated with each bQTL.\nTRANS_ACTORS: A prefix to CSV files containing quantitative trait loci potentially interacting with the previous bqtls. If multiple transcription factors (TFs) are included in a single run, you must include a column called TF, which specifies the TF associated with each transactor.\nEXTRA_CONFOUNDERS, default: nothing: Path to additional confounders file, one per line, no header.\nEXTRA_COVARIATES, default: nothing: Path to additional covariates file, one per line, no header.\nENVIRONMENTALS, default: nothing: Path to additional environmental treatments file, one per line, no header.\nORDERS, default: \"1,2\": Comma separated list describing the order of desired interaction estimands, 1 for the ATE (no interaction), 2 for pairwise interactions etc... e.g. \"1,2\"","category":"page"},{"location":"targene/configuration/#If-SVPtrue","page":"Configuration","title":"If SVP=true","text":"","category":"section"},{"location":"targene/configuration/","page":"Configuration","title":"Configuration","text":"GRM_NSPLITS, default: 100: To fasten GRM computation, it is typically split in batches.\nNB_SVP_ESTIMATORS, default: 100: Number of sieve variance estimates per curve. Setting this value to 0 results in skipping sieve variance correction.\nMAX_SVP_THRESHOLD, default: 0.9: Variance estimates are computed for tau ranging from 0 to MAXSVPTHRESHOLD\nPVAL_THRESHOLD, default: 0.05: Only results with a p-value below this threshold are considered for Sieve Plateau Variance correction.\nESTIMATOR_KEY, default: TMLE: The p-value for PVAL_THRESHOLD is computed using the result from this estimator.","category":"page"},{"location":"targene/configuration/#Secondary-Options","page":"Configuration","title":"Secondary Options","text":"","category":"section"},{"location":"targene/configuration/","page":"Configuration","title":"Configuration","text":"RNG, default: 123: General random seed used to induce permutation.\nVERBOSITY, default: 0: Verbosity level of the the Workflow's processes.\nBATCH_SIZE, default: 400: The set of estimands to be estimated is batched and the Targeted Learning processes will run in parallel across batches.\nTL_SAVE_EVERY, default: 50: During the estimation process, results are appended to the file in chunks to free memory.\nKEEP_IC, default: SVP: To save the Influence Curves for each estimate. Depending on the size of your dataset, this can result in massive disk usage.","category":"page"},{"location":"overview/#Overview","page":"Overview","title":"Overview","text":"","category":"section"},{"location":"overview/#Running-the-Workflows","page":"Overview","title":"Running the Workflows","text":"","category":"section"},{"location":"overview/","page":"Overview","title":"Overview","text":"Since TarGene uses Nextflow, all workflows can be run in the same way from the command line:","category":"page"},{"location":"overview/","page":"Overview","title":"Overview","text":"nextflow run https://github.com/TARGENE/targene-pipeline/ -r TAG -entry WORKFLOW_NAME -profile P -resume","category":"page"},{"location":"overview/","page":"Overview","title":"Overview","text":"where:","category":"page"},{"location":"overview/","page":"Overview","title":"Overview","text":"TAG is the latest TarGene version, e.g. v0.9.0\nWORKFLOW_NAME is any of the TarGene workflows\nP is a Nextflow profile describing your run environment (see Environment Configuration).","category":"page"},{"location":"overview/","page":"Overview","title":"Overview","text":"Additional Nextflow command line arguments can be found in their documentation, for example:","category":"page"},{"location":"overview/","page":"Overview","title":"Overview","text":"-resume: Tells Nextflow to try to resume the pipeline if an error occurred during the execution (if you forgot to specify a parameter for instance)\n-with-trace and -with-report will generate additional report files.","category":"page"},{"location":"overview/#Workflows-Configurations","page":"Overview","title":"Workflows Configurations","text":"","category":"section"},{"location":"overview/","page":"Overview","title":"Overview","text":"There are mainly two parts to configuring a workflow run. The first part describes the execution and environment and the second part describes your actual project. When running the nextflow run command, Nextflow will look for a nextflow.config configuration file in your current directory. If you are new to Nextflow, we suggest you use this file to setup both the environment and project configurations. As your project grows you may want to benefit from splitting this file in more modular components.","category":"page"},{"location":"overview/#Environment-Configuration","page":"Overview","title":"Environment Configuration","text":"","category":"section"},{"location":"overview/","page":"Overview","title":"Overview","text":"It is likely that you will run TarGene on a HPC platform, in particular the Executors and Singularity configurations are required. Since Nextflow is so widespread, it is probable that such a configuration file is already available from your HPC administrators. Since this configuration only describes de computing platform and not your project, it is often described as a Profile. If your HPC uses the SGE executor, the -profile eddie may work with no, or minor adjustment (it can also serve as a template for other executors see file).","category":"page"},{"location":"overview/#Project-Configuration","page":"Overview","title":"Project Configuration","text":"","category":"section"},{"location":"overview/","page":"Overview","title":"Overview","text":"These are the configuration details associated with your project, this is usually done in a nextflow.config file living at the root of your project's directory. The configuration parameters are specific to each workflow and described in the following sections. There are currently two main workflows and two secondary workflows within TarGene.","category":"page"},{"location":"overview/#Main-Workflows","page":"Overview","title":"Main Workflows","text":"","category":"section"},{"location":"overview/","page":"Overview","title":"Overview","text":"The TarGene Workflow (WORKFLOW_NAME: TARGENE): It is the main workflow for the targeted estimation of genetic effects.","category":"page"},{"location":"overview/#Secondary-Workflows","page":"Overview","title":"Secondary Workflows","text":"","category":"section"},{"location":"overview/","page":"Overview","title":"Overview","text":"The PCA Workflow (WORKFLOW_NAME: PCA): This workflow computes principal components.\nThe Make Dataset Workflow (WORKFLOW_NAME: MAKE_DATASET): This workflow generates an aggregated dataset from traits and genetic data.","category":"page"},{"location":"examples/phewas/#PheWAS","page":"PheWAS","title":"PheWAS","text":"","category":"section"},{"location":"examples/phewas/","page":"PheWAS","title":"PheWAS","text":"A phenome-wide association study (PheWAS) is a study design whereby the effect of a variant, or set of variants is estimated for a large number of traits or outcomes.  In TarGene, running a PheWAS is always done implicitely because the outcomes are defined as all variables in the TRAITS_DATASET that do not play a particular role as per the ESTIMANDS_FILE.","category":"page"},{"location":"examples/phewas/","page":"PheWAS","title":"PheWAS","text":"To run a PheWAS for 3 genetic variants we will use the flat configuration mode in the ESTIMANDS_FILE that we will save as \"newphewasconfig.yaml\".","category":"page"},{"location":"examples/phewas/","page":"PheWAS","title":"PheWAS","text":"type: flat\n\nestimands:\n  - type: ATE\n\nvariants:\n  - 1:238411180:T:C\n  - 3:3502414:T:C\n  - 2:14983:G:A\n\noutcome_extra_covariates:\n  - \"Skin colour\"\n  - \"Cheese intake\"","category":"page"},{"location":"examples/phewas/","page":"PheWAS","title":"PheWAS","text":"The estimands section is set to include Average Treatment Effects: ATE. A PheWAS will then be run for all traits in the TRAITS_DATASET that are not in outcome_extra_covariates.","category":"page"},{"location":"examples/phewas/","page":"PheWAS","title":"PheWAS","text":"Then the nextflow.config file is simply:","category":"page"},{"location":"examples/phewas/","page":"PheWAS","title":"PheWAS","text":"params {\n    ESTIMANDS_CONFIG = \"new_phewas_config.yaml\"\n\n    // UK-Biobank specific parameters\n    BED_FILES = \"unphased_bed/ukb_chr{1,2,3}.{bed,bim,fam}\"\n    UKB_CONFIG = \"ukbconfig_small.yaml\"\n    TRAITS_DATASET = \"dataset.csv\"\n    UKB_WITHDRAWAL_LIST = \"withdrawal_list.txt\"\n}","category":"page"},{"location":"examples/phewas/","page":"PheWAS","title":"PheWAS","text":"And the command-line to be run:","category":"page"},{"location":"examples/phewas/","page":"PheWAS","title":"PheWAS","text":"nextflow run https://github.com/TARGENE/targene-pipeline -r v0.11.0 -profile local","category":"page"},{"location":"#TarGene","page":"Home","title":"TarGene","text":"","category":"section"},{"location":"#What-is-TarGene?","page":"Home","title":"What is TarGene?","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"TarGene is a Nexflow workflow that estimates the effect of genetic variations on human traits via Targeted Learning. Targeted Learning is a modern framework that combines advances in causal inference, machine-learning and statistical theory to answer impactful scientific questions. In population genetics, these questions are diverse: single variant effect, epistatic interactions, gene-environment interactions and more! In TarGene, we thus provide targeted estimators that leverage machine-learning algorithms to answer these questions, while preserving valid statistical inference.","category":"page"},{"location":"","page":"Home","title":"Home","text":"In a nutshell, TarGene uses machine-learning models to estimate two predictive functions: the outcome model Q_Y and the propensity score G. These models are then optimally combined to obtain a targeted estimate for the genetic effect of interest, which is here denoted by beta. Genetic effects are defined as causal quantities that measure they effect of change (but see below). The following picture illustrates two distinct genotype changes: mathrmCC rightarrow mathrmCT and mathrmCT rightarrow mathrmTT. Note that there is no need for parametric assumption like linearity and flexible modelling strategies can be employed. However, linear models are also part of the machine-learning family, so you can use them as well if you like. You could actually combine multiple models in a more powerful Super Learner, this is all integrated into TarGene.","category":"page"},{"location":"","page":"Home","title":"Home","text":"(Image: \"Illustrated Causal Model\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"note: Causal Interpretation\nThe fact that genetic effects can be interpreted as causal effects is entirely dependent on the validity of the causal model, which rely on two critical assumptionsNo unobserved confounders. In TarGene, confounding variables are currently learnt via Principal Component Analysis. While PCA could partly capture genetic ancestry, the problem of linkage disequilibrium remains.\nPositivity. This means that the genetic variants under investigation should have non-zero probability under all confounding variables values. In TarGene, we tackle this issue via a heuristic, which is similar to the usual minor allele frequency threshold employed in GWAS.","category":"page"},{"location":"#What-TarGene-Can-Do","page":"Home","title":"What TarGene Can Do","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"TarGene provides baked-in facilities for most popular study designs that aim at understanding the effect of genetic variations on human traits. Hopefully you can find what you are looking for in the following list of supported study-designs:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Genome-Wide Association Studies\nPhenome-Wide Association Studies\nFocused Study of:\nSingle or Joint variants effects\nGene-Gene interactions up to any order\nGene-Environment interactions up to any order","category":"page"},{"location":"#What-TarGene-Can't-Do-(Yet)","page":"Home","title":"What TarGene Can't Do (Yet)","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Targeted Learning is extremly powerful because it provides taylored estimation strategies for each question of interest. Most of the questions that can be currently answered with statistical confidence are population level questions. That is, while TarGene uses predictive machine-learning models to estimate genetic effects, these predictive models are not the output of the software themselves. Furthermore, because each estimator is targeted, it means additional work must be done for each new question that comes up. For instance, one thing that TarGene can't do just yet is to estimate Heritability, but if you are interested we'd love to hear from you!","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"If you are using TarGene on a High-Performance Computing platform, it is likely software dependencies are already available. Since TarGene is a Nextflow pipeline, all you need is:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Nextflow >= 24.04.4","category":"page"},{"location":"","page":"Home","title":"Home","text":"For reproducibility TarGene uses containeraziation technologies so you will also need one of:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Singularity >= 3.8.6\nDocker >= 27.0.3","category":"page"},{"location":"","page":"Home","title":"Home","text":"Versions are indicative, any recent version should work.","category":"page"},{"location":"#Basic-Usage","page":"Home","title":"Basic Usage","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"TarGene can be run from the command line through Nextflow:","category":"page"},{"location":"","page":"Home","title":"Home","text":"nextflow run https://github.com/TARGENE/targene-pipeline/ -r TARGENE_VERSION -c CONFIG_FILE -resume","category":"page"},{"location":"","page":"Home","title":"Home","text":"where:","category":"page"},{"location":"","page":"Home","title":"Home","text":"TARGENE_VERSION is the latest TarGene version, e.g. v0.11.0.\nCONFIG_FILE is a plain Nextflow configuration file describing what you want to do. Writing this configuration file is the hard work that this documentation is all about! However it needs not be scary, can could be as simple as:","category":"page"},{"location":"","page":"Home","title":"Home","text":"params {\n    ESTIMANDS_CONFIG = \"path to estimands config\"\n    ESTIMATORS_CONFIG = \"value or path to estimator config\"\n    BED_FILES = \"path to bed files\"\n    ...\n}","category":"page"},{"location":"#Citing-TarGene","page":"Home","title":"Citing TarGene","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Labayle, O., Tetley-Campbell, K., Slaughter, J., Roskams-Hieter, B., Beentjes, S., Khamseh, A., & Ponting, C. TarGene [Computer software]. https://github.com/TARGENE/targene-pipeline","category":"page"},{"location":"#References","page":"Home","title":"References","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Dispensing with unnecessary assumptions in population genetics analysis. Olivier Labayle Pabet, Kelsey Tetley-Campbell, Mark J. van der Laan, Chris P. Ponting, Sjoerd Viktor Beentjes, Ava Khamseh. bioRxiv 2022.09.12.507656; doi: https://doi.org/10.1101/2022.09.12.507656 ","category":"page"},{"location":"#Getting-in-touch","page":"Home","title":"Getting in touch","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Please feel free to raise an issue if you face a problem or would benefit from a new feature. Contributions are most welcome.","category":"page"},{"location":"targene/study_designs/#Study-Designs","page":"Study Designs","title":"Study Designs","text":"","category":"section"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"A study design describes what are the questions of interest for a given TarGene run. In particular, it answers the two following questions:","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"What variants are of interest?\nWhat are the quantities of interest: Average Treatment Effects, Epistatic Interactions, Gene by Environment Interactions, ...?","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"While specifying your estimands, it may be useful to keep the following causal model in mind.","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"(Image: Causal Graph)","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"Where V_1V_p are a set of genetic variants, the Y_1Y_K are a set of traits and C are a set of additional predictors for Y but not confounding the genetic effects.","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"The following sections describe the available study designs available in TarGene and assumes the following notations:","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"ATE: Average Treatment Effect\nAIE: Interaction Average Treatment Effect\nCM: Conditional Mean","category":"page"},{"location":"targene/study_designs/#CUSTOM","page":"Study Designs","title":"CUSTOM","text":"","category":"section"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"This is the most general setting and should match the needs of any project, however it requires some preliminary work. In this setting, one typically provides a file containing a list of the estimands of interest. If you are interested in only a few estimands, it may be acceptable to write them by hand. Otherwise it is best to generate them using a programming language (for instance using TMLE.jl). The path to those estimands is then provided with the ESTIMANDS_CONFIG Nextflow parameter. Estimands are specified via a YAML file as follows:","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"type: \"Configuration\"\nestimands:\n  - outcome_extra_covariates: []\n    type: \"ATE\"\n    treatment_values:\n      3:3502414:T:C:\n        case: \"TT\"\n        control: \"CT\"\n      1:238411180:T:C:\n        case: \"TC\"\n        control: \"TT\"\n    outcome: ALL\n    treatment_confounders: []\n  - outcome_extra_covariates: []\n    type: \"AIE\"\n    treatment_values:\n      3:3502414:T:C:\n        case: \"TT\"\n        control: \"CT\"\n      1:238411180:T:C:\n        case: \"TC\"\n        control: \"TT\"\n    outcome: ALL\n    treatment_confounders:\n      3:3502414:T:C: []\n      1:238411180:T:C: []\n  - outcome_extra_covariates: []\n    type: \"CM\"\n    treatment_values:\n      3:3502414:T:C: \"CT\"\n      1:238411180:T:C: \"TC\"\n    outcome: ALL\n    treatment_confounders:\n      3:3502414:T:C: []\n      1:238411180:T:C: []\n  - outcome_extra_covariates: []\n    type: \"ATE\"\n    treatment_values:\n      2:14983:G:A:\n        case: \"GG\"\n        control: \"AG\"\n    outcome: ALL\n    treatment_confounders: []\n  - outcome_extra_covariates: []\n    type: \"CM\"\n    treatment_values:\n      2:14983:G:A: \"AG\"\n    outcome: ALL\n    treatment_confounders: []","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"For each estimand:","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"type: refers to the type of effect size (ATE, AIE, CM)\noutcome: The trait of interest. If using the Uk-Biobank datasource it must match the phenotypes/name field in the associated UKB_CONFIG file. You can also use the wildcard \"ALL\" to specify that you want to estimate this parameter accross all traits in the dataset.\ntreatment_values: For each treatment variable (genetic-variant / environmental variables), the control/case contrasts.\ntreatment_confounders: If each treatment's set of confounding variables is assumed to be the same, it can be a list of these variables. Otherwise, for each treatment variable, a list of confounding variables. Note that principal components will be added to that list automatically and must not be provided here. You can provide an empty list.\noutcome_extra_covariates: This is optional and correspond to a list of additional covariates for the prediction of the trait.","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"Note that variants must be encoded via an explicit genotype string representation (e.g. \"AC\"), the order of the alleles in the genotype is not important.","category":"page"},{"location":"targene/study_designs/#ALLELE_INDEPENDENT","page":"Study Designs","title":"ALLELE_INDEPENDENT","text":"","category":"section"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"This mode aims to make it easy to generate estimands without explicitly having to write them down. We still rely on a YAML ESTIMANDS_CONFIG, that contains the following fields:","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"type: How the variants will be combined to generate estimands (see below).\nestimands: A list of the followings:\ntype: The type of generated estimands (CM, ATE, AIE)\norders: With respect to treatment variables if more than two are provided, the combination orders to be generated. For interactions, the order is always greater or equal than 2.\nvariants: The list of genetic variants of interest, see below for how this can be specified.\nextra_treatments: Environmental treatment variables that are added to the treatments combinations.\noutcome_extra_covariates: Additional covariates predictive of the outcomes\nextra_confounders: Confounding variables other than Principal Components.","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"In TarGene, the effect of a variant (or set of variants) on a trait is not defined in terms of a parametric model. As such, the effect size of a variant on a trait is in fact multidimensional, a vector for which each entry corresponds to a specific genotype change. As an example, if a variant RSID_17 has two alleles \"A\" and \"G\", some possible genotype changes are: AA → AG, AG → GG, AA → GG, GG → AA, ... However, some effects of these changes are redundant, e.g. the effect of AA → GG can be obtained from the effects of AA → AG and AG → GG via simple addition. TarGene will only compute transitive changes, in this case only: AA → AG and AG → GG need to be estimated since any other change can be obtained from them.","category":"page"},{"location":"targene/study_designs/#type-flat","page":"Study Designs","title":"type = flat","text":"","category":"section"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"In this mode, genetic variants are provided as a flat list, for each estimand type and order specified in the estimands section, the estimands are generated using combinations.","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"For example, with the following file:","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"type: flat\n\nestimands:\n  - type: AIE\n    orders: [2, 3]\n  - type: ATE\n\nvariants:\n  - RSID_17\n  - RSID_99\n  - RSID_102\n\nextra_treatments:\n  - TREAT_1\n\noutcome_extra_covariates:\n  - COV_1\n\nextra_confounders:\n  - 21003\n  - 22001","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"Average Treatment Effects of order 1 (default) for all (RSID17, RSID99, RSID102, TREAT1) are generated\nInteraction Effects of order 2 and 3 for all combinations of (RSID17, RSID99, RSID102, TREAT1) are generated. Some of these combinations are:\n(RSID17, RSID99)\n(RSID102, TREAT1)\n(RSID102, RSID99, TREAT_1)\n...","category":"page"},{"location":"targene/study_designs/#type-groups","page":"Study Designs","title":"type = groups","text":"","category":"section"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"When the number of variants becomes large, estimating all combinations becomes both computationally expensive and reduces power due to the associated multiple testing burden. If the genetic variants are not chosen at random but based on some biological mechanism (e.g. a transcription factor), it is more efficient to group them. Within each group further subgroups can be defined for the roles played by each variant, only combinations across groups are considered.","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"For example, the following file describes two groups each consisting of two subgroups:","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"type: groups\nestimands:\n  - type: AIE\n    orders: [2, 3]\nvariants:\n  TF1:\n    bQTLs:\n      - RSID_17\n      - RSID_99\n    eQTLs:\n      - RSID_102\n  TF2:\n    bQTLs:\n      - RSID_17\n      - RSID_198\n    eQTLs:\n      - RSID_2\nextra_treatments:\n  - TREAT_1\noutcome_extra_covariates:\n  - COV_1\nextra_confounders:\n  - 21003\n  - 22001","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"For group TF1, only (RSID17, RSID102) and (RSID99, RSID102) are considered and similarly for group TF2.","category":"page"},{"location":"targene/study_designs/#FROM_ACTORS","page":"Study Designs","title":"FROM_ACTORS","text":"","category":"section"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"In this setting the goal is to infer the interaction effect between multiple variants and potential external factors, interacting together via a specific biological mechanism. Typically, multiple sets of variants are of interest and each set is identified with a specific molecule, contributing to the mechanism. In particular, it is assumed that a set of variants, usually binding quantitative trait loci (bQTLs) play a pivotal role. All interactions of interest are thus defined with respect to that set of genetic variations. Let's Consider the following scenario: we know that a transcription factor binds to molecules x and y and then differentially binds to specific regions in the genome (bQTLs) to regulate downstream genes. We suspect that an alteration of this mechanism is responsible for some diseases. A set of xQTLs, associated with the expression of x and a set of yQTLs associated with the expression of y have been identified. Together xQTLs and yQTLs variants are termed \"trans actors\". We further suspect that some environmental factors may influence this process. From that scenario, there are many questions that can be asked, for instance : \"What is the interaction effects of a bQTL with an environmental factor?\". This is a simple pairwise interaction setting and more complex scenarios can be envisaged as described in the following graph.","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"<div style=\"text-align:center\">\n<img src=\"../assets/from_actors.png\" alt=\"FromActors\" style=\"width:600px;\"/>\n</div>","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"Let us now turn to the pipeline specification for this parameter plan:","category":"page"},{"location":"targene/study_designs/","page":"Study Designs","title":"Study Designs","text":"BQTLS: A path to a .csv file containing at least an ID column for each rsID and an optional CHR column for the chromosome on which the SNP is located.\nTRANS_ACTORS: A path prefix to a set of .csv files identifying different trans-acting variants. Each file has the same format as for the bQTLs.\nENVIRONMENTALS: A path to a .txt file containing a list of environmental exposures with no header and one exposure per line. Each exposure should be available from the trait dataset.\nEXTRA_COVARIATES: A path to a .txt file containing a list of extra covariate variables with no header and one variable per line. Each variable should be available from the trait dataset.\nEXTRA_CONFOUNDERS: A path to a .txt file containing a list of extra confounding variables with no header and one variable per line. Each variable should be available from the trait dataset.\nORDERS: A comma separated string that specifies the various interaction orders of interest. All combinations satisfying the positivity constraint will be generated. The order 1 corresponds to the Average Treatment Effect (ATE) for bQTLs, any higher order corresponds to the Interaction Average Treatment Effect (IATE) for the various actors. For example, in the previous scenario, assume we provided ORDERS=1,2. This would generate parameter files for the estimation of all:\nATEs estimands for all bQTLs\nAIEs estimands for all (bQTLs, xQTLs), (bQTLs, yQTLs), (bQTLs, Envs) pairs.","category":"page"},{"location":"user_guide/results/#Understanding-TarGene's-Outputs","page":"Understanding TarGene's Outputs","title":"Understanding TarGene's Outputs","text":"","category":"section"},{"location":"user_guide/results/","page":"Understanding TarGene's Outputs","title":"Understanding TarGene's Outputs","text":"{\n    \"TMLE_GLM_GLM\": {\n        \"n\": 485,\n        \"estimates\": [\n            {\n                \"std\": 15.622429857504532,\n                \"n\": 485,\n                \"type\": \"TMLEstimate\",\n                \"IC\": [],\n                \"estimate\": -0.6186142282443571,\n                \"estimand\": {\n                    \"outcome_extra_covariates\": [\n                        \"Cheese intake\",\n                        \"Number of vehicles in household\"\n                    ],\n                    \"type\": \"ATE\",\n                    \"treatment_values\": {\n                        \"1:15944765:G:A\": {\n                            \"control\": 0,\n                            \"case\": 1\n                        }\n                    },\n                    \"outcome\": \"Body mass index (BMI)\",\n                    \"treatment_confounders\": {\n                        \"1:15944765:G:A\": [\n                            \"PC1\",\n                            \"PC2\",\n                            \"PC3\",\n                            \"PC4\",\n                            \"PC5\",\n                            \"PC6\"\n                        ]\n                    }\n                }\n            },\n            {\n                \"std\": 10.820703990065084,\n                \"n\": 485,\n                \"type\": \"TMLEstimate\",\n                \"IC\": [],\n                \"estimate\": -0.404886039735767,\n                \"estimand\": {\n                    \"outcome_extra_covariates\": [\n                        \"Cheese intake\",\n                        \"Number of vehicles in household\"\n                    ],\n                    \"type\": \"ATE\",\n                    \"treatment_values\": {\n                        \"1:15944765:G:A\": {\n                            \"control\": 1,\n                            \"case\": 2\n                        }\n                    },\n                    \"outcome\": \"Body mass index (BMI)\",\n                    \"treatment_confounders\": {\n                        \"1:15944765:G:A\": [\n                            \"PC1\",\n                            \"PC2\",\n                            \"PC3\",\n                            \"PC4\",\n                            \"PC5\",\n                            \"PC6\"\n                        ]\n                    }\n                }\n            }\n        ],\n        \"type\": \"TMLE.JointEstimate\",\n        \"cov\": [\n            [244.06031465264908, -71.3344199317966],\n            [-71.3344199317966, 117.08763484061052]\n        ],\n        \"estimand\": {\n            \"type\": \"TMLE.JointEstimand\",\n            \"args\": [\n                {\n                    \"outcome_extra_covariates\": [\n                        \"Cheese intake\",\n                        \"Number of vehicles in household\"\n                    ],\n                    \"type\": \"ATE\",\n                    \"treatment_values\": {\n                        \"1:15944765:G:A\": {\n                            \"control\": 0,\n                            \"case\": 1\n                        }\n                    },\n                    \"outcome\": \"Body mass index (BMI)\",\n                    \"treatment_confounders\": {\n                        \"1:15944765:G:A\": [\n                            \"PC1\",\n                            \"PC2\",\n                            \"PC3\",\n                            \"PC4\",\n                            \"PC5\",\n                            \"PC6\"\n                        ]\n                    }\n                },\n                {\n                    \"outcome_extra_covariates\": [\n                        \"Cheese intake\",\n                        \"Number of vehicles in household\"\n                    ],\n                    \"type\": \"ATE\",\n                    \"treatment_values\": {\n                        \"1:15944765:G:A\": {\n                            \"control\": 1,\n                            \"case\": 2\n                        }\n                    },\n                    \"outcome\": \"Body mass index (BMI)\",\n                    \"treatment_confounders\": {\n                        \"1:15944765:G:A\": [\n                            \"PC1\",\n                            \"PC2\",\n                            \"PC3\",\n                            \"PC4\",\n                            \"PC5\",\n                            \"PC6\"\n                        ]\n                    }\n                }\n            ]\n        }\n    },\n    \"OSE_GLM_GLM\": {\n        \"n\": 485,\n        \"estimates\": [\n            {\n                \"std\": 15.695012511050656,\n                \"n\": 485,\n                \"type\": \"OSEstimate\",\n                \"IC\": [],\n                \"estimate\": -0.5009846779180457,\n                \"estimand\": {\n                    \"outcome_extra_covariates\": [\n                        \"Cheese intake\",\n                        \"Number of vehicles in household\"\n                    ],\n                    \"type\": \"ATE\",\n                    \"treatment_values\": {\n                        \"1:15944765:G:A\": {\n                            \"control\": 0,\n                            \"case\": 1\n                        }\n                    },\n                    \"outcome\": \"Body mass index (BMI)\",\n                    \"treatment_confounders\": {\n                        \"1:15944765:G:A\": [\n                            \"PC1\",\n                            \"PC2\",\n                            \"PC3\",\n                            \"PC4\",\n                            \"PC5\",\n                            \"PC6\"\n                        ]\n                    }\n                }\n            },\n            {\n                \"std\": 10.820968353562348,\n                \"n\": 485,\n                \"type\": \"OSEstimate\",\n                \"IC\": [],\n                \"estimate\": -0.4036203473738083,\n                \"estimand\": {\n                    \"outcome_extra_covariates\": [\n                        \"Cheese intake\",\n                        \"Number of vehicles in household\"\n                    ],\n                    \"type\": \"ATE\",\n                    \"treatment_values\": {\n                        \"1:15944765:G:A\": {\n                            \"control\": 1,\n                            \"case\": 2\n                        }\n                    },\n                    \"outcome\": \"Body mass index (BMI)\",\n                    \"treatment_confounders\": {\n                        \"1:15944765:G:A\": [\n                            \"PC1\",\n                            \"PC2\",\n                            \"PC3\",\n                            \"PC4\",\n                            \"PC5\",\n                            \"PC6\"\n                        ]\n                    }\n                }\n            }\n        ],\n        \"type\": \"TMLE.JointEstimate\",\n        \"cov\": [\n            [246.33341772203678, -71.41251770729579],\n            [-71.41251770729579, 117.09335610879779]\n        ],\n        \"estimand\": {\n            \"type\": \"TMLE.JointEstimand\",\n            \"args\": [\n                {\n                    \"outcome_extra_covariates\": [\n                        \"Cheese intake\",\n                        \"Number of vehicles in household\"\n                    ],\n                    \"type\": \"ATE\",\n                    \"treatment_values\": {\n                        \"1:15944765:G:A\": {\n                            \"control\": 0,\n                            \"case\": 1\n                        }\n                    },\n                    \"outcome\": \"Body mass index (BMI)\",\n                    \"treatment_confounders\": {\n                        \"1:15944765:G:A\": [\n                            \"PC1\",\n                            \"PC2\",\n                            \"PC3\",\n                            \"PC4\",\n                            \"PC5\",\n                            \"PC6\"\n                        ]\n                    }\n                },\n                {\n                    \"outcome_extra_covariates\": [\n                        \"Cheese intake\",\n                        \"Number of vehicles in household\"\n                    ],\n                    \"type\": \"ATE\",\n                    \"treatment_values\": {\n                        \"1:15944765:G:A\": {\n                            \"control\": 1,\n                            \"case\": 2\n                        }\n                    },\n                    \"outcome\": \"Body mass index (BMI)\",\n                    \"treatment_confounders\": {\n                        \"1:15944765:G:A\": [\n                            \"PC1\",\n                            \"PC2\",\n                            \"PC3\",\n                            \"PC4\",\n                            \"PC5\",\n                            \"PC6\"\n                        ]\n                    }\n                }\n            ]\n        }\n    }\n}","category":"page"}]
}
