<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Setting a data source · TarGene</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://TARGENE.github.io/targene-pipeline/data_sources/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TarGene</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../overview/">Overview</a></li><li class="is-active"><a class="tocitem" href>Setting a data source</a><ul class="internal"><li><a class="tocitem" href="#UK-Biobank"><span>UK-Biobank</span></a></li></ul></li><li><a class="tocitem" href="../confounding_adjustment/">Adjusting for confounders</a></li><li><a class="tocitem" href="../parameter_specification/">Describing the causal parameters of interest</a></li><li><a class="tocitem" href="../tmle/">Specifying a Targeted Estimator</a></li><li><a class="tocitem" href="../sieve_variance/">Correcting for population relatedness</a></li><li><a class="tocitem" href="../miscellaneous/">Tweaking additional behaviour</a></li><li><a class="tocitem" href="../negative_control/">Running negative control checks</a></li></ul></li><li><span class="tocitem">Miscellaneous</span><ul><li><a class="tocitem" href="../nextflow_params/">Index of the pipeline parameters</a></li><li><a class="tocitem" href="../runtime_considerations/">Some Runtime considerations</a></li></ul></li><li><span class="tocitem">Developper Guide</span><ul><li><a class="tocitem" href="../project_organization/">Project Organization</a></li><li><a class="tocitem" href="../contribution_guide/">Contributing</a></li></ul></li><li><a class="tocitem" href="../associated_softwares/">Associated Softwares</a></li><li><a class="tocitem" href="../publications/">Related Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Setting a data source</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Setting a data source</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/TARGENE/targene-pipeline/blob/main/docs/src/data_sources.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Setting-a-data-source"><a class="docs-heading-anchor" href="#Setting-a-data-source">Setting a data source</a><a id="Setting-a-data-source-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-a-data-source" title="Permalink"></a></h1><p>Currently, only the UK-Biobank is supported, work is under way to enable custom data sources!</p><h2 id="UK-Biobank"><a class="docs-heading-anchor" href="#UK-Biobank">UK-Biobank</a><a id="UK-Biobank-1"></a><a class="docs-heading-anchor-permalink" href="#UK-Biobank" title="Permalink"></a></h2><p>The UK-Biobank is composed of both genetic data (.bed and .bgen files) and trait data. While there is a plan to use only bgen and trait data, the pipeline currently uses all sources of information. Below we explain how to specify those arguments to TarGene. For more information on the structure of the UK-Biobank data, please refer to their <a href="https://biobank.ndph.ox.ac.uk/crystal/exinfo.cgi?src=accessing_data_guide">User Guide</a>.</p><h3 id="Main-Dataset"><a class="docs-heading-anchor" href="#Main-Dataset">Main Dataset</a><a id="Main-Dataset-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Dataset" title="Permalink"></a></h3><p>The trait dataset is often called the &quot;main dataset&quot; and consists of an encrypted file containing individuals&#39; trait information accessible via your project. The first option is thus to provide this dataset using the <code>ENCRYPTED_DATASET</code> parameter. Since the data is encrypted, the pipeline will also need the encoding file that you can provide with <code>ENCODING_FILE</code>.</p><p>A &quot;main dataset&quot; is typically very large and only a few traits will be of interest to a given study. To extract those relevant traits from the dataset, a <code>TRAITS_CONFIG</code> YAML file must be provided. Since, writing by hand such a file for large scale study can quickly become tenuous, we provide a configuration file corresponding to the <a href="http://geneatlas.roslin.ed.ac.uk/">GeneAtlas</a> study <a href="https://github.com/TARGENE/UKBMain.jl/blob/main/config/geneatlas_config.yaml">here</a>.</p><p>The structure of a file is composed of extraction rules that convert UK-Biobank fields to traits of interest. An example is presented below:</p><pre><code class="language-yaml hljs">traits:
    - fields:
        - &quot;41202&quot;
        - &quot;41204&quot;
      phenotypes:
        - name: &quot;Chronic lower respiratory diseases&quot;
          codings:
            - &quot;J40&quot;
            - &quot;J41&quot;
            - &quot;J410&quot;
            - &quot;J411&quot;
            - &quot;J418&quot;
            - &quot;J42&quot;
            - &quot;J43&quot;
        - name: &quot;Other extrapyramidal and movement disorders&quot;
          codings:
            - &quot;G254&quot;
            - &quot;G255&quot;
            - &quot;G256&quot;
            - &quot;G258&quot;
    - fields:
        - &quot;40006&quot;
      phenotypes:
        - name: &quot;Malignant melanoma of skin&quot;
          codings:
            - &quot;C430&quot;
            - &quot;C431&quot;
            - &quot;C432&quot;
            - &quot;C433&quot;
            - &quot;C434&quot;
            - &quot;C435&quot;
            - &quot;C436&quot;
            - &quot;C437&quot;
            - &quot;C438&quot;
            - &quot;C439&quot;
    - fields:
        - &quot;1558&quot;
      phenotypes:
        - name: &quot;Alcohol intake frequency.&quot;
    - fields:
        - &quot;20117&quot;
      phenotypes:
        - name: &quot;Alcohol drinker status&quot;

subset: 
    - fields: 22001
      phenotypes:
        - name: Female
          codings: 0
    - fields: 21000
      phenotypes:
        - name: White
          codings: [1001]</code></pre><p>A file consists of two sections, a <code>traits</code> section and a <code>subset</code> section. Each section is further divided in a list of <code>fields</code> items. Each <code>fields</code> item is itself decomposed in multiple <code>phenotypes</code> items that are identified by a <code>name</code> and an optional list of <code>codings</code>. Alltogether, a phenotype element defines an extraction rule from a list of fields. The previous configuration file would thus restrict the analysis to white females and extract 5 traits.</p><p>We now describe the currently available extraction rules based on variable types. Not that a variable type is determined by the <a href="https://biobank.ndph.ox.ac.uk/ukb/schema.cgi?id=1">metadata</a> provided by the UK-Biobank and not a programmatic rule.</p><ul><li>Continuous/Count variables: Those consist in a single <code>field</code> and the extraction rule will take the first visit assessment value for that field. For instance, the &quot;Alcohol intake frequency.&quot; is simply the value from the &quot;1558-0.0&quot; column.</li><li>Ordinal data: Some variables are encoded as categorical by the UK-Biobank but an ordinal interpretation seems more appropriate. A list of such variables has been identified and hard-coded. They will be treated like continuous variables.</li><li>Categorical variables: For those variables again, the first visit assessment value for the specified field is used. An additional <code>codings</code> field can be provided. In that case the variable is turned into a indicator variable indicating whether an individual is included in the criterion given by the <code>codings</code> list. In the previous <code>subset</code> section, &quot;White&quot; is such a transformation into a binary variable. Note that we could add more elements to the list to subset on a wider population.</li><li>Categorical Arrayed variables: Some fields in the UK-Biobank consist in list of traits for individuals. This is the case for at least the fields: 41202, 41204, 20002 and 40006. For those fields it is essential to define a <code>codings</code> section that describes a trait. For instance &quot;Malignant melanoma of skin&quot; corresponds to the declaration of any of the <code>codings</code> for an individual. Moreover, some fields share the same encoding, this is the case for  41202 and 41204. In that situation it may be useful to aggregate those sources of information. For that purpose multiple fields can be provided to the <code>fields</code> section. In that scenario the declaration of any of the coding in a <code>codings</code> section for any of the <code>fields</code> will define the trait.</li></ul><p>To come back to the pipeline specification, if a &quot;typical&quot; main dataset has already been decrypted outside of the pipeline, one may use the <code>DECRYPTED_DATASET</code> as an input to the pipeline instead of the <code>ENCRYPTED_DATASET</code> and <code>ENCODING_FILE</code> arguments. However, please make sure that all the fields in the <code>TRAITS_CONFIG</code> file described above are contained in this dataset.</p><p>Note: Since this decrypted dataset is a plain CSV file, one may build and add extra columns to it. Any column in the decrypted dataset which does not correspond to a UK-Biobank field will be considered as such.</p><h3 id="Genetic-Data"><a class="docs-heading-anchor" href="#Genetic-Data">Genetic Data</a><a id="Genetic-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Genetic-Data" title="Permalink"></a></h3><p>We are currently using both .bgen and .bed files, furthermore, we assume that the data is <strong>unphased</strong>. Those are respectively provided with the <code>UKBB_BGEN_FILES</code> and <code>UKBB_BED_FILES</code> parameters. Since the UK-Biobank genotyping data is split in chromosomes, it should be of the form <code>PREFIX_TO_CHROMOSOMES{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22}.{bgen,sample,bgen.bgi}</code> and <code>PREFIX_TO_CHROMOSOMES{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22}.{bed,bim,fam}</code> respectively.</p><h3 id="Additional-Files"><a class="docs-heading-anchor" href="#Additional-Files">Additional Files</a><a id="Additional-Files-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-Files" title="Permalink"></a></h3><p>Additional UK-Biobank required files for preprocessing and filtering are:</p><ul><li><code>QC_FILE</code>: A path to the UK-Biobank SNP quaility control <a href="https://biobank.ctsu.ox.ac.uk/crystal/refer.cgi?id=1955"><code>ukb_snp_qc.txt</code></a> file.</li><li><code>WITHDRAWAL_LIST</code>: A path to the withdrawal sample list to exclude removed participants from the study.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../overview/">« Overview</a><a class="docs-footer-nextpage" href="../confounding_adjustment/">Adjusting for confounders »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 21 July 2023 14:18">Friday 21 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
