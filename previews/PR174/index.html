<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · TarGene</title><meta name="title" content="Home · TarGene"/><meta property="og:title" content="Home · TarGene"/><meta property="twitter:title" content="Home · TarGene"/><meta name="description" content="Documentation for TarGene."/><meta property="og:description" content="Documentation for TarGene."/><meta property="twitter:description" content="Documentation for TarGene."/><meta property="og:url" content="https://TARGENE.github.io/targene-pipeline/"/><meta property="twitter:url" content="https://TARGENE.github.io/targene-pipeline/"/><link rel="canonical" href="https://TARGENE.github.io/targene-pipeline/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>TarGene</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#What-is-TarGene?"><span>What is TarGene?</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Basic-Usage"><span>Basic Usage</span></a></li><li><a class="tocitem" href="#Citing-TarGene"><span>Citing TarGene</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li><li><a class="tocitem" href="#Getting-in-touch"><span>Getting in touch</span></a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="examples/setup/">Setup (Read First)</a></li><li><a class="tocitem" href="examples/gwas/">GWAS</a></li><li><a class="tocitem" href="examples/phewas/">PheWAS</a></li><li><a class="tocitem" href="examples/interactions/">Interaction Study</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="overview/">Nextflow Basics</a></li><li><a class="tocitem" href="all_workflows_parameters/">Index of Workflows Parameters</a></li><li><a class="tocitem" href="runtime_considerations/">Some Runtime considerations</a></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">The Discovery Workflow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="targene/overview/">Overview</a></li><li><a class="tocitem" href="targene/data_sources/">Genetic and Traits Data</a></li><li><a class="tocitem" href="targene/confounding_adjustment/">PCA Adjustment</a></li><li><a class="tocitem" href="targene/study_designs/">Defining the Estimands of Interest</a></li><li><a class="tocitem" href="targene/tmle/">Specifying a Targeted Estimator</a></li><li><a class="tocitem" href="targene/sieve_variance/">Correcting for population relatedness (Experimental)</a></li><li><a class="tocitem" href="targene/miscellaneous/">Final Tweaks</a></li><li><a class="tocitem" href="targene/outputs/">Understanding TarGene&#39;s Outputs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">The Simulation Workflows (Experimental)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="simulations/overview/">Overview</a></li><li><a class="tocitem" href="simulations/null_simulation/">Null Simulation</a></li><li><a class="tocitem" href="simulations/realistic_simulation/">Realistic Simulation</a></li><li><a class="tocitem" href="simulations/simulation_outputs/">Description of Simulations Outputs</a></li></ul></li></ul></li><li><span class="tocitem">Secondary Workflows</span><ul><li><a class="tocitem" href="secondary_workflows/pca/">The PCA Workflow</a></li><li><a class="tocitem" href="secondary_workflows/make_dataset/">The Make Dataset Workflow</a></li></ul></li><li><span class="tocitem">Developper Guide</span><ul><li><a class="tocitem" href="developer_guide/project_organization/">Project Organization</a></li><li><a class="tocitem" href="developer_guide/contribution_guide/">Contributing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TARGENE/targene-pipeline/blob/main/docs/src/index.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="TarGene"><a class="docs-heading-anchor" href="#TarGene">TarGene</a><a id="TarGene-1"></a><a class="docs-heading-anchor-permalink" href="#TarGene" title="Permalink"></a></h1><h2 id="What-is-TarGene?"><a class="docs-heading-anchor" href="#What-is-TarGene?">What is TarGene?</a><a id="What-is-TarGene?-1"></a><a class="docs-heading-anchor-permalink" href="#What-is-TarGene?" title="Permalink"></a></h2><p>TarGene is a reproducible and scalable <a href="https://www.nextflow.io/">Nexflow</a> pipeline that estimates the effect of genetic variations on human traits via <a href="https://link.springer.com/book/10.1007/978-1-4419-9782-1">Targeted Learning</a>.</p><h3 id="TarGene-Estimates-the-Effect-of-Change"><a class="docs-heading-anchor" href="#TarGene-Estimates-the-Effect-of-Change">TarGene Estimates the Effect of Change</a><a id="TarGene-Estimates-the-Effect-of-Change-1"></a><a class="docs-heading-anchor-permalink" href="#TarGene-Estimates-the-Effect-of-Change" title="Permalink"></a></h3><p>Genetic effects are defined as causal quantities measuring the effect of change. The following picture illustrates two distinct genotype changes, <span>$\mathrm{CC} \rightarrow \mathrm{CT}$</span> and <span>$\mathrm{CT} \rightarrow \mathrm{TT}$</span>, each corresponding to a different genetic effect. Note that there is no need for a parametric model to define the effect of such changes. A single variant effect is defined model independently by the <a href="https://en.wikipedia.org/wiki/Average_treatment_effect">Average Treatment Effect</a>. For a single genotype change, it is for example given by</p><p class="math-container">\[\beta_{\mathrm{CC} \rightarrow \mathrm{CT}} = \mathbb{E}[Y | do(CT)] - \mathbb{E}[Y | do(CC)]\]</p><p><img src="assets/illustrated_causal_model.png" alt="&quot;Illustrated Causal Model&quot;"/></p><div class="admonition is-info"><header class="admonition-header">Causal Interpretation</header><div class="admonition-body"><p>The fact that genetic effects can be interpreted as causal effects is entirely dependent on the validity of the causal model, which rely on two critical assumptions</p><ol><li>No unobserved confounders. In TarGene, confounding variables are currently inferred via Principal Component Analysis. While PCA could partly capture genetic ancestry, the problem of <a href="https://www.nature.com/articles/s43586-021-00056-9">linkage disequilibrium</a> remains.</li><li>Positivity. This means that the genetic variants under investigation should have non-zero probability under all confounding variables values. In TarGene, we tackle this issue via a heuristic, which is similar to the usual minor allele frequency threshold employed in GWAS.</li></ol></div></div><h3 id="How-TarGene-Works?"><a class="docs-heading-anchor" href="#How-TarGene-Works?">How TarGene Works?</a><a id="How-TarGene-Works?-1"></a><a class="docs-heading-anchor-permalink" href="#How-TarGene-Works?" title="Permalink"></a></h3><p>Targeted Learning is a modern framework that combines advances in causal inference, machine-learning and statistical theory to answer impactful scientific questions. In population genetics, these questions are diverse: single variant effect, epistatic interactions, gene-environment interactions and more! In TarGene, we thus provide targeted estimators that leverage machine-learning algorithms to answer these questions, while preserving valid statistical inference.</p><p>Briefly, TarGene uses machine-learning models to estimate two predictive functions:</p><ul><li>The outcome regression model: <span>$Q_Y = \mathbb{E}[Y | V, W]$</span>.</li><li>The propensity score or variant model: <span>$G = P(V | W)$</span>.</li></ul><p>The problem is that naively using machine-learning models to estimate <span>$Q_Y$</span>, will lead to biased estimates for our genetic effects like <span>$\beta_{\mathrm{CC} \rightarrow \mathrm{CT}}$</span>. The estimators we use in TarGene use the propensity score to reduce this bias and yield a targeted <span>$\hat{\beta}^*_{\mathrm{CC} \rightarrow \mathrm{CT}}$</span>. The resulting estimators are asymptotically normal, unbiased and efficient (with minimum variance). We can thus use flexible modelling strategies and still obtain valid confidence regions and p-values.</p><h3 id="What-TarGene-Can-Do"><a class="docs-heading-anchor" href="#What-TarGene-Can-Do">What TarGene Can Do</a><a id="What-TarGene-Can-Do-1"></a><a class="docs-heading-anchor-permalink" href="#What-TarGene-Can-Do" title="Permalink"></a></h3><p>TarGene provides baked-in facilities for most popular study designs that aim at understanding the effect of genetic variations on human traits. Hopefully you can find what you are looking for in the following list of supported study-designs:</p><ul><li>Genome-Wide Association Studies</li><li>Phenome-Wide Association Studies</li><li>Focused Study of:<ul><li>Single or Joint variants effects</li><li>Gene-Gene interactions up to any order</li><li>Gene-Environment interactions up to any order</li></ul></li></ul><h3 id="What-TarGene-Can&#39;t-Do-(Yet)"><a class="docs-heading-anchor" href="#What-TarGene-Can&#39;t-Do-(Yet)">What TarGene Can&#39;t Do (Yet)</a><a id="What-TarGene-Can&#39;t-Do-(Yet)-1"></a><a class="docs-heading-anchor-permalink" href="#What-TarGene-Can&#39;t-Do-(Yet)" title="Permalink"></a></h3><p>Targeted Learning is extremly powerful because it provides taylored estimation strategies for each question of interest. Most of the questions that can be currently answered with statistical confidence are population level questions. That is, while TarGene uses predictive machine-learning models to estimate genetic effects, these predictive models are not the output of the software themselves. Furthermore, because each estimator is targeted, it means additional work must be done for each new question that comes up. For instance, one thing that TarGene can&#39;t do just yet is to estimate Heritability, but if you are interested we&#39;d love to hear from you!</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>If you are using TarGene on a High-Performance Computing platform, it is likely software dependencies are already available.</p><p>Since TarGene is a Nextflow pipeline, all you need is:</p><ul><li><a href="https://www.nextflow.io/docs/latest/install.html">Nextflow</a> &gt;= 24.04.4</li></ul><p>For reproducibility, TarGene uses containerization technologies. You will also need one of:</p><ul><li><a href="https://docs.sylabs.io/guides/3.0/user-guide/installation.html">Singularity</a> &gt;= 3.8.6</li><li><a href="https://docs.docker.com/engine/install/">Docker</a> &gt;= 27.0.3</li></ul><p>Versions are indicative, any recent version should work.</p><h2 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h2><p>TarGene can be run from the command line through Nextflow:</p><pre><code class="language-bash hljs">nextflow run https://github.com/TARGENE/targene-pipeline/ -r TARGENE_VERSION -c CONFIG_FILE -resume</code></pre><p>where:</p><ul><li><code>TARGENE_VERSION</code> is the latest TarGene version, e.g. <code>v0.11.0</code>.</li><li><code>CONFIG_FILE</code> is a plain Nextflow configuration file describing what you want to do. Writing this configuration file is the hard work that this documentation is all about! However it needs not be scary, can could be as simple as:</li></ul><pre><code class="language-conf hljs">params {
    ESTIMANDS_CONFIG = &quot;path to estimands config&quot;
    ESTIMATORS_CONFIG = &quot;value or path to estimator config&quot;
    BED_FILES = &quot;path to bed files&quot;
    ...
}</code></pre><h2 id="Citing-TarGene"><a class="docs-heading-anchor" href="#Citing-TarGene">Citing TarGene</a><a id="Citing-TarGene-1"></a><a class="docs-heading-anchor-permalink" href="#Citing-TarGene" title="Permalink"></a></h2><p>Labayle, O., Tetley-Campbell, K., Slaughter, J., Roskams-Hieter, B., Beentjes, S., Khamseh, A., &amp; Ponting, C. TarGene [Computer software]. https://github.com/TARGENE/targene-pipeline</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>Dispensing with unnecessary assumptions in population genetics analysis. Olivier Labayle Pabet, Kelsey Tetley-Campbell, Mark J. van der Laan, Chris P. Ponting, Sjoerd Viktor Beentjes, Ava Khamseh. bioRxiv 2022.09.12.507656; doi: <a href="https://www.biorxiv.org/content/10.1101/2022.09.12.507656v1">https://doi.org/10.1101/2022.09.12.507656</a></p><h2 id="Getting-in-touch"><a class="docs-heading-anchor" href="#Getting-in-touch">Getting in touch</a><a id="Getting-in-touch-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-in-touch" title="Permalink"></a></h2><p>Please feel free to <a href="https://github.com/TARGENE/targene-pipeline/issues">raise an issue</a> if you face a problem or would benefit from a new feature. Contributions are most welcome.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="examples/setup/">Setup (Read First) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 24 October 2024 17:43">Thursday 24 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
