<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Genetic and Traits Data · TarGene</title><meta name="title" content="Genetic and Traits Data · TarGene"/><meta property="og:title" content="Genetic and Traits Data · TarGene"/><meta property="twitter:title" content="Genetic and Traits Data · TarGene"/><meta name="description" content="Documentation for TarGene."/><meta property="og:description" content="Documentation for TarGene."/><meta property="twitter:description" content="Documentation for TarGene."/><meta property="og:url" content="https://TARGENE.github.io/targene-pipeline/targene/data_sources/"/><meta property="twitter:url" content="https://TARGENE.github.io/targene-pipeline/targene/data_sources/"/><link rel="canonical" href="https://TARGENE.github.io/targene-pipeline/targene/data_sources/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TarGene</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/setup/">Setup (Read First)</a></li><li><a class="tocitem" href="../../examples/gwas/">GWAS</a></li><li><a class="tocitem" href="../../examples/phewas/">PheWAS</a></li><li><a class="tocitem" href="../../examples/interactions/">Interaction Study</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../overview/">Nextflow Basics</a></li><li><a class="tocitem" href="../../all_workflows_parameters/">Index of Workflows Parameters</a></li><li><a class="tocitem" href="../../runtime_considerations/">Some Runtime considerations</a></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox" checked/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">The Discovery Workflow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../overview/">Overview</a></li><li class="is-active"><a class="tocitem" href>Genetic and Traits Data</a><ul class="internal"><li><a class="tocitem" href="#Genetic-Data"><span>Genetic Data</span></a></li><li><a class="tocitem" href="#Traits-Dataset"><span>Traits Dataset</span></a></li></ul></li><li><a class="tocitem" href="../confounding_adjustment/">PCA Adjustment</a></li><li><a class="tocitem" href="../study_designs/">Defining the Estimands of Interest</a></li><li><a class="tocitem" href="../tmle/">Specifying a Targeted Estimator</a></li><li><a class="tocitem" href="../sieve_variance/">Correcting for population relatedness (Experimental)</a></li><li><a class="tocitem" href="../miscellaneous/">Final Tweaks</a></li><li><a class="tocitem" href="../outputs/">Understanding TarGene&#39;s Outputs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">The Simulation Workflows (Experimental)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../simulations/overview/">Overview</a></li><li><a class="tocitem" href="../../simulations/null_simulation/">Null Simulation</a></li><li><a class="tocitem" href="../../simulations/realistic_simulation/">Realistic Simulation</a></li><li><a class="tocitem" href="../../simulations/simulation_outputs/">Description of Simulations Outputs</a></li></ul></li></ul></li><li><span class="tocitem">Secondary Workflows</span><ul><li><a class="tocitem" href="../../secondary_workflows/pca/">The PCA Workflow</a></li><li><a class="tocitem" href="../../secondary_workflows/make_dataset/">The Make Dataset Workflow</a></li></ul></li><li><span class="tocitem">Developper Guide</span><ul><li><a class="tocitem" href="../../developer_guide/project_organization/">Project Organization</a></li><li><a class="tocitem" href="../../developer_guide/contribution_guide/">Contributing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li><a class="is-disabled">The Discovery Workflow</a></li><li class="is-active"><a href>Genetic and Traits Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Genetic and Traits Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TARGENE/targene-pipeline/blob/main/docs/src/targene/data_sources.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Genetic-and-Traits-Data"><a class="docs-heading-anchor" href="#Genetic-and-Traits-Data">Genetic and Traits Data</a><a id="Genetic-and-Traits-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Genetic-and-Traits-Data" title="Permalink"></a></h1><p>The dataset is the main ingredient manipulated by TarGene. Population Genetics datasets are typically split into a variety of files and formats. The following section describes these formats and how to input them to a TarGene run.</p><h2 id="Genetic-Data"><a class="docs-heading-anchor" href="#Genetic-Data">Genetic Data</a><a id="Genetic-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Genetic-Data" title="Permalink"></a></h2><p>TarGene currently only works with genotyping arrays datasets. These datasets can come in multiple formats and we currently use both <code>bgen</code> and <code>bed</code> formats. It is also assumed that the genotyping data is <strong>unphased</strong>. and split in chromosomes.</p><p>Unless you are performing a GWAS, both <code>bgen</code> and <code>bed</code> files are required. This is because PCA uses the <code>bed</code> files while the variants of interest are looked up within the more comprehensive <code>bgen</code> files. Since the later format does not provide variant calls but only imputation probabilities, the <code>CALL_THRESHOLD (default: 0.9)</code> parameter is used to call genotypes. In the GWAS setting, the complete list of all variants within the <code>.bed</code> files is used for analysis.</p><p>The <code>bgen</code> and <code>bed</code> files are provided via the <code>BGEN_FILES</code> and <code>BED_FILES</code> Nextflow parameters respectively. For example:</p><ul><li><code>BGEN_FILES=&quot;path_to_folder/imputed_chr{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22}.{bgen,sample,bgen.bgi}&quot;</code> </li><li><code>BED_FILES=&quot;path_to_folder/genotyped_chr{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22}.{bed,bim,fam}</code></li></ul><div class="admonition is-success"><header class="admonition-header">File Names</header><div class="admonition-body"><p>It is advised to deviate as little as possible from the prefix above (prefix ending in &quot;chr&quot;) to make sure everything works smoothly.</p></div></div><h2 id="Traits-Dataset"><a class="docs-heading-anchor" href="#Traits-Dataset">Traits Dataset</a><a id="Traits-Dataset-1"></a><a class="docs-heading-anchor-permalink" href="#Traits-Dataset" title="Permalink"></a></h2><p>In addition to genetic data, a set of traits is usually also available in a different format. We currently support two types of cohorts: the UK Biobank and custom CSV datasets.</p><h3 id="Custom-Traits-Dataset"><a class="docs-heading-anchor" href="#Custom-Traits-Dataset">Custom Traits Dataset</a><a id="Custom-Traits-Dataset-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Traits-Dataset" title="Permalink"></a></h3><p>Select with <code>COHORT = &quot;MY_COHORT&quot;</code> (The actual name does not matter as long as it does not match an existing cohort).</p><p>TarGene supports custom traits datasets in CSV format, that can be provided via the <code>TRAITS_DATASET</code> parameter. Please ensure the sample-ids identifying individuals in your cohort are included as the first column of your trait data, with the column name <code>SAMPLE_ID</code>.</p><h3 id="UK-Biobank"><a class="docs-heading-anchor" href="#UK-Biobank">UK-Biobank</a><a id="UK-Biobank-1"></a><a class="docs-heading-anchor-permalink" href="#UK-Biobank" title="Permalink"></a></h3><p>Select with <code>COHORT = &quot;UKB&quot;</code>.</p><p>If the dataset provided as <code>TRAITS_DATASET</code> is the encrypted dataset (potentially suffixed by <code>enc_ukb</code>), then the decryption file must be provided via <code>UKB_ENCODING_FILE</code>. If you have already decrypted the dataset, you don&#39;t need to provide a <code>UKB_ENCODING_FILE</code>. We refer to either the encrypted or decrypted dataset as the main dataset.</p><p>The information contained in the UK-Biobank main dataset is not directly usable for statistical analyses and needs to be processed. This is both because the data format is <a href="https://uk-biobank.gitbook.io/data-access-guide/the-main-dataset/the-structure-of-a-main-dataset">non-standard</a> and because some fields contain information about multiple phenotypes. Furthermore, multiple fields can also be combined to define custom phenotypes. The <code>UKB_CONFIG</code> file lets you provide a mapping between the UK Biobank Data-Fields and actual phenotypes. By default, it defines 110 non-binary and 660 binary traits as previously defined by the <a href="http://geneatlas.roslin.ed.ac.uk/">geneATLAS</a>. In cases, you may be interested in only a few traits or would like to define more. The goal of the following sections is to help you do that. We first describe some of the main UK-Biobank fields, then explain the rules according to which they are converted into individual phenotypes and end with some examples.</p><h4 id="Data-Fields-Description"><a class="docs-heading-anchor" href="#Data-Fields-Description">Data Fields Description</a><a id="Data-Fields-Description-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Fields-Description" title="Permalink"></a></h4><p>Phenotypes in the UK-Biobank are organised in Data-Fields, that may contain information about multiple phenotypes or can be combined, here is a non-exhaustive lit of them.</p><p><em>Diagnoses made during hospital inpatient admission</em> (467 traits, Data-Fields <a href="https://biobank.ndph.ox.ac.uk/ukb/field.cgi?id=41204">41204</a> and <a href="https://biobank.ndph.ox.ac.uk/ukb/field.cgi?id=41202">41202</a>). This category contains information relating to main and secondary diagnoses made during hospital inpatient admissions. Each trait in this category corresponds to a node or set of nodes in the International Classification of Diseases 10-th Revision (ICD10) ontology. For example, &quot;K41 Femoral hernia&quot; is defined by any of the following diagnoses (&quot;K410&quot;, &quot;K411&quot;, &quot;K412&quot;, &quot;K413&quot;, &quot;K414&quot;, &quot;K419&quot;).</p><p><em>Self reported conditions</em> (161 traits, Data-Field <a href="https://biobank.ndph.ox.ac.uk/ukb/field.cgi?id=20002">20002</a>). This category contains data obtained through a verbal interview by a trained nurse on past and current medical conditions, including type of cancer and other illnesses, the number of medical conditions, and date of diagnosis. This field can contain inaccuracies due to recall bias or intentional misreporting.</p><p><em>Self reported conditions</em> (29 traits, Data-Field <a href="https://biobank.ndph.ox.ac.uk/ukb/field.cgi?id=40006">40006</a>) This category contains coded data on cancer incidence, obtained through linkage to national cancer registries. Because data is continually accruing, the number of cases may vary depending on the time the data is sent out to researchers.</p><p><em>Further Miscellaneous fields</em> (113 traits) These traits do not correspond to diseases but to various lifestyle behaviours or biological measurements. For instance Data-Field 30180 corresponds to Lymphocyte percentage in a blood assay while Data-Field 1389 corresponds to Pork intake.</p><h4 id="The-Extraction-Rules"><a class="docs-heading-anchor" href="#The-Extraction-Rules">The Extraction Rules</a><a id="The-Extraction-Rules-1"></a><a class="docs-heading-anchor-permalink" href="#The-Extraction-Rules" title="Permalink"></a></h4><p>Phenotypes are defined from fields according to rules. These rules are either defined at the field level, or based on its &quot;value type&quot; <a href="https://biobank.ndph.ox.ac.uk/ukb/schema.cgi?id=1">metadata</a>, which indicates the data type the field contains. Here we summarise these rules.</p><p><em>Continuous and Integer Fields</em> (value type = 31, 11 respectively). These contain one or more values per individual corresponding to the multiple visit assessments. The value of the field at the first visit assessment is extracted. For instance, the &quot;Alcohol intake frequency.&quot; is simply the value from the &quot;1558-0.0&quot; column.</p><p><em>Ordinal Fields</em> (1408, 1727, 1548, 728, 1717, 1389, 1478, 1518, 1558, 1349, 1359, 1369, 1379, 1329, 1339, 1239, 1687, 1697, 1319, 1498). Some variables are encoded as categorical by the UK-Biobank, but an ordinal interpretation seems more appropriate. For instance, &quot;Lamb intake&quot; ranges from 0 (Never) to 5 (Once or more daily). Similarly to continuous fields, the value of the field at the first visit assessment is extracted. Negative values (Do not know, Prefer not to answer) are treated as missing.</p><p><em>Categorical Fields</em> (value type = 21). These variables cannot be turned into continuous variables and are usually represented via a coding. For instance, the field 21000, described as Ethnic background, uses coding 1001 for British individuals, 4001 for Caribbeans 5 for Chinese etc... These can currently be processed in two different ways by TarGene. Either the coding of each individual is extracted, or, if multiple codings are specified, an indicator of these codings is produced (1 or 0). For instance, &quot;White&quot; could be defined as any of the following codings {1001, 1002, 1003}, that is British, Irish or Any other white background. Similarly to ordinal variables, the value at the first visit assessment is extracted and negative values are considered missing.</p><p><em>Categorical Arrayed Fields</em> ({40006, 20002, 41202, 41204}). Some fields in the UK-Biobank comprise a list of codings for each individual at each visit. Each coding represents, for example, a disease or condition that was diagnosed or self reported. A phenotype is then defined by a set of codings. As an example, we define &quot;oesophageal disorder&quot; as the set of the following codings: {1134, 1139, 1140, 1141, 1138, 1474} from Data-Field 20002. An individual annotated with any of these codings, at any assessment visit, is considered a case for &quot;oesophageal disorder&quot;. Moreover, some fields share the same codings, this is the case for 41202 and 41204. In that situation it may be useful to aggregate these sources of information. For instance, &quot;G20 Parkinson&#39;s disease&quot; is defined by the single element set {G20}, in any of the 41202 and 41204 Data-Fields.</p><h4 id="The-UKB_CONFIG-Configuration-File"><a class="docs-heading-anchor" href="#The-UKB_CONFIG-Configuration-File">The <code>UKB_CONFIG</code> Configuration File</a><a id="The-UKB_CONFIG-Configuration-File-1"></a><a class="docs-heading-anchor-permalink" href="#The-UKB_CONFIG-Configuration-File" title="Permalink"></a></h4><p>We now explain how these rules are encoded within the <code>UKB_CONFIG</code> YAML file. For reference, the default <a href="https://github.com/TARGENE/targene-pipeline/blob/main/assets/ukbconfig.yaml">configuration file</a> corresponds to the <a href="http://geneatlas.roslin.ed.ac.uk/">geneATLAS</a> study and can be used as a template.</p><p>The structure of the <code>UKB_CONFIG</code> YAML file consists of extraction rules that convert UK-Biobank fields to traits of interest. It contains two sections, a <code>traits</code> section and a <code>subset</code> section.</p><ul><li>The <code>traits</code> section describes the phenotypes that need to be extracted from the main <code>TRAITS_DATASET</code>.</li><li>The <code>subset</code> section provides a way to filter the data based on specific traits and hence estimate conditional effects. Each element in this section corresponds to an additional condition to be met by an individual. For instance, the default configuration only includes White individuals.</li></ul><p>Each section is further divided in a list of <code>fields</code> items that match the UK-Biobank <a href="https://biobank.ctsu.ox.ac.uk/crystal/help.cgi?cd=data_field">data fields</a> and a list of <code>phenotypes</code> that can be extracted from these fields. Each phenotype in the <code>phenotypes</code> subsection of the <code>UKB_CONFIG</code> YAML file is identified by a <code>name</code> and an optional list of <code>codings</code> defining it. Altogether, a phenotype element defines an extraction rule from a list of fields and codings.</p><p>It is probably more helpful to look at an example:</p><pre><code class="language-yaml hljs">traits:
    - fields:
        - &quot;41202&quot;
        - &quot;41204&quot;
      phenotypes:
        - name: &quot;Chronic lower respiratory diseases&quot;
          codings:
            - &quot;J40&quot;
            - &quot;J41&quot;
            - &quot;J410&quot;
            - &quot;J411&quot;
            - &quot;J418&quot;
            - &quot;J42&quot;
            - &quot;J43&quot;
        - name: &quot;Other extrapyramidal and movement disorders&quot;
          codings:
            - &quot;G254&quot;
            - &quot;G255&quot;
            - &quot;G256&quot;
            - &quot;G258&quot;
    - fields:
        - &quot;40006&quot;
      phenotypes:
        - name: &quot;Malignant melanoma of skin&quot;
          codings:
            - &quot;C430&quot;
            - &quot;C431&quot;
            - &quot;C432&quot;
            - &quot;C433&quot;
            - &quot;C434&quot;
            - &quot;C435&quot;
            - &quot;C436&quot;
            - &quot;C437&quot;
            - &quot;C438&quot;
            - &quot;C439&quot;
    - fields:
        - &quot;1558&quot;
      phenotypes:
        - name: &quot;Alcohol intake frequency.&quot;
    - fields:
        - &quot;20117&quot;
      phenotypes:
        - name: &quot;Alcohol drinker status&quot;

subset: 
    - fields: 22001
      phenotypes:
        - name: Female
          codings: 0
    - fields: 21000
      phenotypes:
        - name: White
          codings: [1001]</code></pre><p>This configuration file restricts the analysis to White females and extract 5 traits.</p><p>The first trait, &quot;Chronic lower respiratory diseases&quot; is defined by <strong>any</strong> of the (J40, J41, J410, J411, J418, J42, J43) codings within <strong>any</strong> of the fields (41202, 41204).</p><p>The phenotype &quot;Malignant melanoma of skin&quot; is defined by any of (C430, C431, C432, C433, C434, C435, C436, C437, C438, C439) within the 40006 field.</p><p>The &quot;Alcohol drinker status&quot; is defined from the first visit assessment questionnaire status.</p><div class="admonition is-success"><header class="admonition-header">Constructing Additional columns</header><div class="admonition-body"><p>If you are providing a decrypted <code>TRAITS_DATASET</code>, you can build and add extra columns to it (for instance to define new phenotypes). Any column in the <code>TRAITS_DATASET</code> which does not correspond to a UK-Biobank field will be considered as such.</p></div></div><h4 id="Additional-Files"><a class="docs-heading-anchor" href="#Additional-Files">Additional Files</a><a id="Additional-Files-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-Files" title="Permalink"></a></h4><p>Additional optional UK-Biobank files for preprocessing and filtering are:</p><ul><li><code>QC_FILE</code>: A path to the UK-Biobank SNP quality control <a href="https://biobank.ctsu.ox.ac.uk/crystal/refer.cgi?id=1955"><code>ukb_snp_qc.txt</code></a> file.</li><li><code>UKB_WITHDRAWAL_LIST</code>: A path to the withdrawal sample list to exclude removed participants from the study.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../overview/">« Overview</a><a class="docs-footer-nextpage" href="../confounding_adjustment/">PCA Adjustment »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 24 October 2024 17:43">Thursday 24 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
