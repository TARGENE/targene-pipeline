<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GWAS · TarGene</title><meta name="title" content="GWAS · TarGene"/><meta property="og:title" content="GWAS · TarGene"/><meta property="twitter:title" content="GWAS · TarGene"/><meta name="description" content="Documentation for TarGene."/><meta property="og:description" content="Documentation for TarGene."/><meta property="twitter:description" content="Documentation for TarGene."/><meta property="og:url" content="https://TARGENE.github.io/targene-pipeline/examples/gwas/"/><meta property="twitter:url" content="https://TARGENE.github.io/targene-pipeline/examples/gwas/"/><link rel="canonical" href="https://TARGENE.github.io/targene-pipeline/examples/gwas/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TarGene</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../setup/">Setup (Read First)</a></li><li class="is-active"><a class="tocitem" href>GWAS</a></li><li><a class="tocitem" href="../phewas/">PheWAS</a></li><li><a class="tocitem" href="../interactions/">Interaction Study</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../overview/">Nextflow Basics</a></li><li><a class="tocitem" href="../../all_workflows_parameters/">Index of Workflows Parameters</a></li><li><a class="tocitem" href="../../runtime_considerations/">Some Runtime considerations</a></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">The Discovery Workflow</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../targene/overview/">Overview</a></li><li><a class="tocitem" href="../../targene/data_sources/">Genetic and Traits Data</a></li><li><a class="tocitem" href="../../targene/confounding_adjustment/">PCA Adjustment</a></li><li><a class="tocitem" href="../../targene/study_designs/">Defining the Estimands of Interest</a></li><li><a class="tocitem" href="../../targene/tmle/">Specifying a Targeted Estimator</a></li><li><a class="tocitem" href="../../targene/sieve_variance/">Correcting for population relatedness (Experimental)</a></li><li><a class="tocitem" href="../../targene/miscellaneous/">Final Tweaks</a></li><li><a class="tocitem" href="../../targene/outputs/">Understanding TarGene&#39;s Outputs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">The Simulation Workflows (Experimental)</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../simulations/overview/">Overview</a></li><li><a class="tocitem" href="../../simulations/null_simulation/">Null Simulation</a></li><li><a class="tocitem" href="../../simulations/realistic_simulation/">Realistic Simulation</a></li><li><a class="tocitem" href="../../simulations/simulation_outputs/">Description of Simulations Outputs</a></li></ul></li></ul></li><li><span class="tocitem">Secondary Workflows</span><ul><li><a class="tocitem" href="../../secondary_workflows/pca/">The PCA Workflow</a></li><li><a class="tocitem" href="../../secondary_workflows/make_dataset/">The Make Dataset Workflow</a></li></ul></li><li><span class="tocitem">Developper Guide</span><ul><li><a class="tocitem" href="../../developer_guide/project_organization/">Project Organization</a></li><li><a class="tocitem" href="../../developer_guide/contribution_guide/">Contributing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>GWAS</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>GWAS</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TARGENE/targene-pipeline/blob/main/docs/src/examples/gwas.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="GWAS"><a class="docs-heading-anchor" href="#GWAS">GWAS</a><a id="GWAS-1"></a><a class="docs-heading-anchor-permalink" href="#GWAS" title="Permalink"></a></h1><p>Perhaps the most common study design in population genetics is the Genome-Wide Association Study (GWAS). In TarGene, a GWAS can only be performed across <a href="https://zzz.bwh.harvard.edu/plink/binary.shtml">plink BED files</a>. A minimalist run configuration for a GWAS in TarGene looks like the following:</p><pre><code class="language-conf hljs">params {
    ESTIMANDS_CONFIG = &quot;gwas_config.yaml&quot;
    ESTIMATORS_CONFIG = &quot;wtmle--glm&quot;

    // UK-Biobank specific parameters
    BED_FILES = &quot;unphased_bed/ukb_chr{1,2,3}.{bed,bim,fam}&quot;
    UKB_CONFIG = &quot;ukbconfig_gwas.yaml&quot;
    TRAITS_DATASET = &quot;dataset.csv&quot;
    UKB_WITHDRAWAL_LIST = &quot;withdrawal_list.txt&quot;
}</code></pre><p>Apart from the data related parameters, there are two main parameters here: <code>ESTIMANDS_CONFIG</code> and the <code>ESTIMATORS_CONFIG</code>. These parameters describe the estimands (questions of interest) and how to estimate them respectively. Since we are performing a GWAS, we are interested in the effect of all variants, across all phenotypes in the <code>UKB_CONFIG</code> file. </p><p>The <code>ESTIMANDS_CONFIG</code> is a pretty succinct YAML file for a GWAS, it could contain only one line. Here we will be a little more fancy and add extra outcome predictors to improve the precision of inference</p><pre><code class="language-yaml hljs">type: gwas

outcome_extra_covariates:
  - &quot;Number of vehicles in household&quot;
  - &quot;Cheese intake&quot;</code></pre><p>The optional <code>outcome_extra_covariates</code> are variables to be used as extra predictors of the outcome (but not as confounders). How does TarGene know how to extract these traits from the the UK Biobank main dataset? This is thanks to the <code>UKB_CONFIG</code> file, which maps UK Biobank data fields to traits (see <a href="../../targene/data_sources/#The-UKB_CONFIG-Configuration-File">The <code>UKB_CONFIG</code> Configuration File</a>). In our case, this file will contain both the outcome of interest (BMI) and the extra predictors we need (Number of vehicles in household and Cheese intake).</p><pre><code class="language-yaml hljs">traits:
  - fields:
      - &quot;21001&quot;
    phenotypes:
      - name: &quot;Body mass index (BMI)&quot;
  - fields:
      - &quot;728&quot;
    phenotypes:
      - name: &quot;Number of vehicles in household&quot;
  - fields:
      - &quot;1408&quot;
    phenotypes:
      - name: &quot;Cheese intake&quot;</code></pre><p>Note that the outcome is defined implicitely, any trait in the <code>UKB_CONFIG</code> file which is not in the <code>outcome_extra_covariates</code> will be considered as an outcome. So you can run multiple GWAS at once by simply adding another trait definition to the above file.</p><p>Finally, the <code>ESTIMATORS_CONFIG = &quot;wtmle--glm&quot;</code> defines the estimation strategy. We will be using Targeted Minimum-Loss Estimator with a simple Generalized Linear Model (glm) to learn the outcome models (<span>$Q_Y$</span>)and propensity scores (<span>$G$</span>).</p><p>The GWAS can then be run as follows:</p><pre><code class="language-bash hljs">nextflow run https://github.com/TARGENE/targene-pipeline -r v0.11.0 -profile local</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../setup/">« Setup (Read First)</a><a class="docs-footer-nextpage" href="../phewas/">PheWAS »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 18 September 2024 11:28">Wednesday 18 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
